<!DOCTYPE html>
<html lang="vi">
<head>
<script src="/js/rw-event-id.js" defer></script>

<!-- ================= META CLIENT PARAM BUILDER ================= -->
<script>
window.addEventListener('load', function () {
  var s = document.createElement('script');
  s.src = 'https://capi-automation.s3.us-east-2.amazonaws.com/public/client_js/capiParamBuilder/clientParamBuilder.bundle.js';
  s.onload = function () {
    try {
      if (!window.RW_EVENT_ID && window.crypto && crypto.randomUUID) {
        window.RW_EVENT_ID = crypto.randomUUID();
      }

      if (window.clientParamBuilder) {
        clientParamBuilder.processAndCollectAllParams(
          window.location.href,
          function () { return ''; }
        );
      }
    } catch (e) {
      console.warn('CAPI init failed', e);
    }
  };
  document.body.appendChild(s);
});
</script>

<!-- ================= CONVERSION EVENT ID STORE ================= -->
<script>
window.RW_FINAL_CONV_EVENTS = {};

function getFinalConvEventId(action) {
  const key = 'rw_final_' + action;

  let eid = sessionStorage.getItem(key);
  if (eid) return eid;

  if (window.RW_FINAL_CONV_EVENTS[action]) {
    return window.RW_FINAL_CONV_EVENTS[action];
  }

  eid =
    (window.crypto && crypto.randomUUID)
      ? crypto.randomUUID()
      : 'rw_' + Date.now() + '_' + Math.random().toString(36).slice(2);

  window.RW_FINAL_CONV_EVENTS[action] = eid;
  sessionStorage.setItem(key, eid);

  return eid;
}
</script>

<!-- ================= FETCH HEADER (PAGEVIEW ONLY) ================= -->
<script>
(function () {
  if (!window.fetch || !window.RW_EVENT_ID) return;

  var originalFetch = window.fetch;
  window.fetch = function (url, options) {
    options = options || {};
    options.headers = options.headers || {};
    options.headers['X-RW-EVENT-ID'] = window.RW_EVENT_ID;
    return originalFetch(url, options);
  };
})();
</script>

<!-- ================= GOOGLE TAG MANAGER ================= -->
<script>
(function(w,d,s,l,i){
  w[l]=w[l]||[];
  w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
  var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),
      dl=l!='dataLayer'?'&l='+l:'';
  j.async=true;
  j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
  f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KNFLM3CR');
</script>

<!-- ================= META PIXEL ================= -->
<script>
!function(f,b,e,v,n,t,s){
if(f.fbq)return;
n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];
t=b.createElement(e);t.async=!0;t.src=v;
s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)
}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init','862531473384426',{}, {autoConfig:false});
fbq('set','autoConfig','862531473384426',false);

if (window.RW_EVENT_ID) {
  fbq('track','PageView');
}
</script>

<!-- ================= PIXEL CONVERSIONS ================= -->
<script>
(function () {
  if (!window.fbq) return;

  /* CALL */
  document.addEventListener('click', function (e) {
    var btn = e.target.closest && e.target.closest('#ruby-call-regular');
    if (!btn) return;
    fbq('trackCustom','CallButtonClick',{},{
      eventID: getFinalConvEventId('call')
    });
  });

  /* FORM – LEAD (SUBMIT THẬT) */
  document.addEventListener('submit', function (e) {
    if (!e.target || e.target.tagName !== 'FORM') return;
    var eid = getFinalConvEventId('lead');
    fbq('track','Lead',{}, { eventID: eid });
  });

  fbq('consent','revoke');
  fbq('consent','grant');
})();
</script>

<!-- ================= CONTACT / CHAT CAPI ================= -->
<script>
(function () {
  function sendContact(source, phone, eventId) {
    fetch('https://ruby-wings-chatbot.onrender.com/api/track-contact', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({
        event_id: eventId,
        phone: phone || '',
        source: source
      })
    });
  }

  /* ZALO – CAPI (1 LẦN / PHIÊN) */
  document.addEventListener('click', function (e) {
    var zalo = e.target.closest && e.target.closest('#rw-zalo-round-btn');
    if (!zalo) return;

    if (sessionStorage.getItem('rw_zalo_capi_sent')) return;
    sessionStorage.setItem('rw_zalo_capi_sent', '1');

    sendContact(
      'Zalo Contact',
      '84332510486',
      getFinalConvEventId('zalo')
    );
  });

  /* CHATBOT – CAPI (1 LẦN / PHIÊN) */
  document.addEventListener('click', function (e) {
    var chat = e.target.closest && e.target.closest('.rw-chat-btn, .rw-chat-btn-isolated');
    if (!chat) return;

    if (sessionStorage.getItem('rw_chat_capi_sent')) return;
    sessionStorage.setItem('rw_chat_capi_sent', '1');

    sendContact(
      'Chatbot Contact',
      '',
      getFinalConvEventId('chat')
    );
  });
})();
</script>

<!-- === HẾT CODE TRACKING === -->
    <!-- === META TAGS SEO TỐI ƯU === -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    
    <!-- Title & Description Tối ưu -->
    <title>Khi tâm trượt dốc từ những điều rất nhỏ: Bài học thức tỉnh từ một vụ án gây chấn động | Ruby Wings</title>
    <meta name="description" content="Phân tích cơ chế tâm lý và khoa học não bộ đằng sau sự trượt dốc tinh thần, qua vụ án chấn động của Đoàn Văn Sáng. Bài học về giữ tâm sạch trong thời đại kích thích.">
    <meta name="keywords" content="Đoàn Văn Sáng, tâm lý tội phạm, trượt dốc tâm lý, khoa học não bộ, giữ tâm sạch, thiền chánh niệm, Ruby Wings, chữa lành tâm trí">
    <meta name="author" content="Lương Tiến Sỹ - Ruby Wings Travel">
    
    <!-- Canonical & Alternate URLs -->
    <link rel="canonical" href="https://rubywings.vn/tam-truot-doc-vu-an-doan-van-sang.html">
    <link rel="alternate" hreflang="vi" href="https://rubywings.vn/tam-truot-doc-vu-an-doan-van-sang.html">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://rubywings.vn/tam-truot-doc-vu-an-doan-van-sang.html">
    <meta property="og:title" content="Khi tâm trượt dốc từ những điều rất nhỏ: Bài học thức tỉnh từ một vụ án gây chấn động">
    <meta property="og:description" content="Phân tích cơ chế tâm lý và khoa học não bộ đằng sau sự trượt dốc tinh thần, qua vụ án chấn động của Đoàn Văn Sáng.">
    <meta property="og:image" content="https://rubywings.vn/images/tam-truot-doc.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Ruby Wings Travel">
    <meta property="og:locale" content="vi_VN">
    <meta property="article:author" content="Lương Tiến Sỹ">
    <meta property="article:published_time" content="2025-01-20T00:00:00+07:00">
    <meta property="article:section" content="Tâm lý & Chữa lành">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://rubywings.vn/tam-truot-doc-vu-an-doan-van-sang.html">
    <meta name="twitter:title" content="Khi tâm trượt dốc từ những điều rất nhỏ: Bài học thức tỉnh">
    <meta name="twitter:description" content="Phân tích cơ chế tâm lý và khoa học não bộ đằng sau sự trượt dốc tinh thần, qua vụ án chấn động.">
    <meta name="twitter:image" content="https://rubywings.vn/images/tam-truot-doc.jpg">
    <meta name="twitter:creator" content="@TienSy379">
    
    <!-- Additional Meta -->
    <meta name="theme-color" content="#2E8B57">
    <meta name="msapplication-TileColor" content="#2E8B57">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <script src="facebook-pixel-complete.js"></script>

    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Organization",
      "@id": "https://rubywings.vn/#organization",
      "name": "Ruby Wings Travel",
      "url": "https://rubywings.vn/",
      "logo": {
        "@type": "ImageObject",
        "url": "https://rubywings.vn/images/logo.png"
      },
      "description": "Ruby Wings Travel là đơn vị xây dựng nội dung và không gian trải nghiệm hướng đến chánh niệm, kết nối thiên nhiên và giáo dục nhận thức, hỗ trợ cá nhân phát triển lối sống cân bằng và bền vững.",
      "telephone": "+84-33-251-0486",
      "email": "rubywingslsa@gmail.com"
    },
    {
      "@type": "Article",
      "@id": "https://rubywings.vn/bai-hoc-thuc-tinh-tu-vu-an-gay-chan-dong.html#article",
      "headline": "Khi Tâm Trượt Dốc Từ Những Điều Rất Nhỏ – Bài Học Thức Tỉnh Từ Một Vụ Án Gây Chấn Động",
      "description": "Bài viết phân tích các cơ chế tâm lý và khoa học thần kinh liên quan đến sự trượt dốc tinh thần của con người trong thời đại kỹ thuật số, từ đó rút ra bài học cảnh tỉnh về việc bảo vệ tâm trí, giữ ranh giới đạo đức và xây dựng khả năng tự điều chỉnh nội tâm.",
      "author": {
        "@type": "Person",
        "name": "Lương Tiến Sỹ"
      },
      "publisher": {
        "@id": "https://rubywings.vn/#organization"
      },
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://rubywings.vn/bai-hoc-thuc-tinh-tu-vu-an-gay-chan-dong.html"
      },
      "articleSection": [
        "Phân tích tâm lý",
        "Nhận thức xã hội",
        "Giáo dục tinh thần"
      ],
      "keywords": [
        "tâm lý học",
        "khoa học thần kinh",
        "kích thích số",
        "kiểm soát cảm xúc",
        "nhận thức",
        "chánh niệm",
        "sức khỏe tinh thần"
      ],
      "datePublished": "2025-01-01",
      "dateModified": "2025-01-01"
    },
    {
      "@type": "WebPage",
      "@id": "https://rubywings.vn/bai-hoc-thuc-tinh-tu-vu-an-gay-chan-dong.html#webpage",
      "url": "https://rubywings.vn/bai-hoc-thuc-tinh-tu-vu-an-gay-chan-dong.html",
      "name": "Khi Tâm Trượt Dốc Từ Những Điều Rất Nhỏ – Bài Học Thức Tỉnh",
      "description": "Trang bài viết phân tích – giáo dục nhận thức xã hội về sự trượt dốc tinh thần và tầm quan trọng của việc bảo vệ tâm trí trong đời sống hiện đại.",
      "isPartOf": {
        "@id": "https://rubywings.vn/#website"
      },
      "primaryImageOfPage": {
        "@type": "ImageObject",
        "url": "https://rubywings.vn/images/bai-hoc-thuc-tinh.jpg"
      },
      "publisher": {
        "@id": "https://rubywings.vn/#organization"
      },
      "breadcrumb": {
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Trang chủ",
            "item": "https://rubywings.vn/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Nhận thức & Giáo dục",
            "item": "https://rubywings.vn/nhan-thuc-giao-duc.html"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "Bài học thức tỉnh"
          }
        ]
      }
    },
    {
      "@type": "WebSite",
      "@id": "https://rubywings.vn/#website",
      "url": "https://rubywings.vn/",
      "name": "Ruby Wings Travel",
      "description": "Du lịch trải nghiệm – Hành trình của chiều sâu",
      "publisher": {
        "@id": "https://rubywings.vn/#organization"
      }
    }
  ]
}
</script>

    <!-- Preload Critical Resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;800&family=Inter:wght@400;500;600;700&display=swap" as="style">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;800&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
   
    <style>
        /* CSS Variables - Healing Colors */
        :root {
            /* Primary Colors */
            --sea-green: #2E8B57;
            --sea-green-light: #3da56d;
            --sea-green-lighter: #5cbd89; /* Màu xanh lá nhạt hơn */
            --sea-green-dark: #1e6b41;
            
            /* Accent Colors */
            --pink: #f41c61;
            --pink-light: #ff5c8d;
            
            /* Neutral Colors */
            --white-smoke: #F5F5F5;
            --dark-slate-gray: #2F4F4F;
            --light-gray: #f8f9fa;
            
            /* Footer Colors */
            --footer-brown: #d4af37;
            --footer-yellow-brown: #e6c34e; /* Màu vàng nâu sáng hơn */
            --footer-green-dark: #1e6b41;
            --footer-green-light: #3da56d;
            
            /* Typography */
            --font-heading: 'Playfair Display', serif;
            --font-body: 'Inter', sans-serif;
            
            /* Spacing */
            --section-padding: 5rem 0;
            --container-max-width: 1400px; /* Tăng chiều rộng container */
            
            /* Effects */
            --shadow-soft: 0 5px 15px rgba(0,0,0,0.08);
            --shadow-medium: 0 10px 30px rgba(0,0,0,0.12);
            --shadow-large: 0 20px 60px rgba(0,0,0,0.15);
            
            /* Transitions */
            --transition-fast: 0.3s ease;
            --transition-medium: 0.5s ease;
            --transition-slow: 0.8s ease;
        }

        /* Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-body);
            font-size: 16px;
            line-height: 1.6;
            color: var(--dark-slate-gray);
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            overflow-x: hidden;
            text-align: justify;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-heading);
            font-weight: 600;
            line-height: 1.3;
            margin-bottom: 1rem;
            color: var(--dark-slate-gray);
            text-align: center;
        }

        h1 {
            font-size: 2.8rem; /* Giảm kích thước tiêu đề chính */
            font-weight: 700;
        }

        h2 {
            font-size: 2.2rem;
        }

        h3 {
            font-size: 1.6rem;
        }

        p {
            margin-bottom: 1rem;
            text-align: justify;
        }

        a {
            text-decoration: none;
            color: inherit;
            transition: var(--transition-fast);
        }

        /* Layout */
        .container {
            max-width: var(--container-max-width);
            margin: 0 auto;
            padding: 0 2rem;
        }

        .section-header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .section-header h2 {
            position: relative;
            display: inline-block;
            margin-bottom: 1rem;
        }

        .section-header h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: var(--pink);
            border-radius: 2px;
        }

        .section-header p {
            font-size: 1.2rem;
            color: #666;
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }

        /* Buttons */
        .btn-primary, .btn-secondary, .btn-outline {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            transition: var(--transition-fast);
            border: none;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: var(--shadow-soft);
        }

        .btn-primary {
            background: var(--sea-green);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
            background: var(--sea-green-dark);
        }

        .btn-secondary {
            background: var(--pink);
            color: white;
            border: 2px solid var(--pink);
        }

        .btn-secondary:hover {
            background: var(--pink-light);
            color: white;
            border-color: var(--pink-light);
        }

        .btn-outline {
            background: transparent;
            color: var(--dark-slate-gray);
            border: 2px solid var(--dark-slate-gray);
        }

        .btn-outline:hover {
            background: var(--dark-slate-gray);
            color: white;
        }

        /* Header - Đã giảm chiều cao */
        #main-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(135deg, #ffdde1 0%, #ffffff 100%);
            backdrop-filter: blur(10px);
            z-index: 1000;
            transition: var(--transition-fast);
            padding: 0.5rem 0; /* Giảm từ 1rem xuống 0.5rem */
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        #main-header.hidden {
            transform: translateY(-100%);
        }

        .header-container {
            max-width: var(--container-max-width);
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-wrapper {
            position: relative;
            width: 100px; /* Giảm kích thước logo để phù hợp với header thấp hơn */
            height: 100px;
        }

        .logo {
            width: 100%;
            height: 100%;
            object-fit: contain;
            z-index: 2;
            position: relative;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }

        /* Xoá hiệu ứng nền logo */
        .logo-background {
            display: none;
        }

        .brand-info {
            display: flex;
            flex-direction: column;
        }

        .brand-name {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
            color: var(--pink);
            letter-spacing: 2px;
            line-height: 1.2;
        }

        .tagline {
            font-size: 0.9rem;
            color: var(--sea-green);
            font-style: italic;
            margin: 0;
            line-height: 1.2;
            font-weight: 600;
            white-space: nowrap; /* Đảm bảo không xuống dòng */
        }

        /* Navigation - Đã loại bỏ dropdown */
        .main-nav {
            display: flex;
            align-items: center;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 1.5rem; /* Giảm khoảng cách để phù hợp với header thấp hơn */
            align-items: center;
        }

        .nav-link {
            font-weight: 500;
            color: var(--sea-green);
            position: relative;
            padding: 0.3rem 0; /* Giảm padding để phù hợp với header thấp hơn */
            transition: var(--transition-fast);
            white-space: nowrap; /* Đảm bảo không xuống dòng */
        }

        .nav-link:hover,
        .nav-link.active {
            color: var(--pink);
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--pink);
            transition: var(--transition-fast);
        }

        .nav-link:hover::after,
        .nav-link.active::after {
            width: 100%;
        }

        .contact-btn {
            background: var(--pink);
            color: white !important;
            padding: 0.5rem 1.2rem; /* Giảm padding để phù hợp với header thấp hơn */
            border-radius: 25px;
            transition: var(--transition-fast);
        }

        .contact-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-soft);
            color: white !important;
            background: var(--sea-green);
        }

        .contact-btn::after {
            display: none;
        }

        /* Mobile Menu - Đã sửa với nút đóng và căn chỉnh */
        .mobile-menu-btn {
            display: none;
            flex-direction: column;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            gap: 4px;
            z-index: 1001;
        }

        .mobile-menu-btn span {
            width: 25px;
            height: 3px;
            background: var(--sea-green);
            transition: var(--transition-fast);
            border-radius: 2px;
        }

        .mobile-menu-btn.active span:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
            background: var(--pink);
        }

        .mobile-menu-btn.active span:nth-child(2) {
            opacity: 0;
        }

        .mobile-menu-btn.active span:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
            background: var(--pink);
        }

        /* Article Content Styles */
        .article-hero {
            padding: 8rem 0 4rem;
            background: linear-gradient(135deg, var(--sea-green-light) 0%, var(--sea-green-dark) 100%);
            color: white;
            text-align: center;
            margin-top: 70px; /* Đảm bảo không bị header che */
        }

        .article-hero h1 {
            font-size: 2.5rem; /* Giảm kích thước tiêu đề */
            margin-bottom: 1.5rem;
            color: white;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }

        .article-meta {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .article-content {
            padding: 4rem 0;
            background: white;
        }

        .content-container {
            max-width: 1200px; /* Tăng chiều rộng nội dung */
            margin: 0 auto;
            padding: 0 2rem;
        }

        .article-section {
            margin-bottom: 3rem;
        }

        .article-section h2 {
            text-align: left;
            margin-bottom: 1.5rem;
            color: var(--sea-green-dark);
            position: relative;
            padding-bottom: 0.5rem;
        }

        .article-section h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: var(--pink);
            border-radius: 2px;
        }

        .article-section h3 {
            text-align: left;
            margin: 2rem 0 1rem;
            color: var(--sea-green);
        }

        .highlight-box {
            background: linear-gradient(135deg, #ffe6e6 0%, #ffcccc 100%);
            border-left: 4px solid var(--pink);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 10px 10px 0;
            box-shadow: var(--shadow-soft);
        }

        .highlight-box p {
            margin: 0;
            font-style: italic;
            color: #ff3366;
            font-weight: 600;
        }

        .benefit-list {
            list-style: none;
            margin: 1.5rem 0;
        }

        .benefit-list li {
            padding: 0.5rem 0;
            position: relative;
            padding-left: 2rem;
        }

        .benefit-list li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: var(--sea-green);
            font-weight: bold;
        }

        .article-image {
            width: 100%;
            height: 400px;
            border-radius: 10px;
            overflow: hidden;
            margin: 2rem 0;
            box-shadow: var(--shadow-medium);
        }

        .article-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-caption {
            text-align: center;
            font-style: italic;
            color: #666;
            margin-top: 0.5rem;
            font-size: 0.9rem;
        }

        /* Vùng khám phá hành trình với màu nền xanh lá nhạt hơn và hiệu ứng */
        .discovery-highlight {
            background: var(--sea-green-lighter);
            padding: 2rem 0;
            text-align: center;
            margin: 3rem 0;
            position: relative;
            overflow: hidden;
            border-radius: 15px;
        }

        .discovery-highlight::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: shimmer 4s infinite;
        }

        .discovery-text {
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
            position: relative;
            z-index: 1;
            margin-bottom: 1.5rem;
        }

        .discovery-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Vùng hình oval dẹt nền trắng hồng với chữ đỏ tươi */
        .oval-banner {
            background: linear-gradient(135deg, #ffe6e6 0%, #ffcccc 100%);
            border-radius: 50px;
            padding: 1.5rem 2rem;
            text-align: center;
            margin: 2rem auto;
            max-width: 90%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .oval-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 4s infinite;
        }

        .oval-banner-text {
            font-size: 1.8rem;
            font-weight: 700;
            color: #ff3366;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1;
        }

        /* Footer - Đã sửa để hiển thị đủ 10 biểu tượng và căn trái */
        footer {
            background: linear-gradient(135deg, var(--footer-green-dark), var(--footer-green-light));
            color: white;
            padding: 2rem 0 1rem; /* Giảm chiều cao footer */
            width: 100%; /* Đảm bảo nền xanh phủ hết */
        }

        .footer-content {
            max-width: var(--container-max-width);
            margin: 0 auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem; /* Giảm khoảng cách */
        }

        .footer-column h3 {
            color: var(--footer-yellow-brown);
            margin-bottom: 0.8rem; /* Giảm khoảng cách */
            font-size: 1.3rem; /* Giảm kích thước chữ */
            text-align: left;
            font-weight: 700; /* Chữ đậm */
            line-height: 1.2; /* Giảm khoảng cách dòng */
        }

        .footer-title-link {
            color: var(--footer-yellow-brown);
            transition: var(--transition-fast);
        }

        .footer-title-link:hover {
            color: var(--pink);
        }

        .footer-column p {
            margin-bottom: 0.8rem; /* Giảm khoảng cách */
            opacity: 0.9;
            line-height: 1.4; /* Giảm khoảng cách dòng */
            text-align: left;
        }

        .social-links-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem; /* Giảm khoảng cách */
            padding-bottom: 5px;
            justify-content: flex-start;
        }

        .social-icon {
            width: 35px;
            height: 35px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: var(--transition-fast);
            flex-shrink: 0;
        }

        .social-icon:hover {
            transform: translateY(-3px);
        }

        .facebook { background: #3b5998; }
        .facebook:hover { background: #4c70ba; }
        .facebook-personal { background: #3b5998; }
        .facebook-personal:hover { background: #4c70ba; }
        .twitter { background: #1da1f2; }
        .twitter:hover { background: #3ab1ff; }
        .instagram { background: #e4405f; }
        .instagram:hover { background: #ff5c7c; }
        .tiktok { background: #000000; }
        .tiktok:hover { background: #333333; }
        .linkedin { background: #0077b5; }
        .linkedin:hover { background: #0095e5; }
        .whatsapp { background: #25d366; }
        .whatsapp:hover { background: #2ef57a; }
        .zalo { background: #0068ff; }
        .zalo:hover { background: #1a7cff; }
        .youtube { background: #ff0000; }
        .youtube:hover { background: #ff3333; }
        .messenger { background: #0084ff; }
        .messenger:hover { background: #339dff; }

        .zalo-icon {
            width: 18px;
            height: 18px;
            border-radius: 50%;
        }

        .contact-info {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 0.5rem; /* Giảm khoảng cách */
            opacity: 0.9;
            text-align: left;
            line-height: 1.3; /* Giảm khoảng cách dòng */
        }

        .contact-info i {
            width: 20px;
            color: var(--footer-yellow-brown);
        }

        .contact-info a {
            color: white;
            transition: var(--transition-fast);
        }

        .contact-info a:hover {
            color: var(--footer-yellow-brown);
        }

        .community-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--pink);
            color: white;
            padding: 0.8rem 1.2rem;
            border-radius: 25px;
            font-weight: 600;
            transition: var(--transition-fast);
            margin-top: 0.5rem;
        }

        .community-btn:hover {
            background: var(--sea-green);
            transform: translateY(-2px);
        }

        .copyright {
            text-align: center;
            padding-top: 1rem; /* Giảm khoảng cách */
            margin-top: 1rem; /* Giảm khoảng cách */
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            opacity: 0.6;
            display: none; /* Ẩn dòng copyright */
        }

        /* Back to Top Button */
        .back-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 50px;
            height: 50px;
            background: var(--pink);
            color: white;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-fast);
            z-index: 100;
            box-shadow: var(--shadow-medium);
        }

        .back-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            background: var(--sea-green);
            transform: translateY(-3px);
        }

        /* Responsive Design - Đã sửa lỗi hiển thị trên mobile */
        @media (max-width: 1024px) {
            .nav-links {
                gap: 1rem; /* Giảm khoảng cách trên tablet */
            }
        }

        @media (max-width: 768px) {
            .header-container {
                padding: 0 1rem;
            }
            
            .nav-links {
                display: none;
            }
            
            .mobile-menu-btn {
                display: flex;
            }
            
            .nav-links.active {
                display: flex;
                flex-direction: column;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100vh;
                background: linear-gradient(135deg, var(--sea-green-dark), var(--sea-green-light));
                box-shadow: var(--shadow-medium);
                padding: 2rem;
                gap: 1.5rem;
                z-index: 999;
                overflow-y: auto;
            }
            
            .nav-links.active .nav-link {
                font-size: 1.2rem; /* Tăng kích thước chữ menu mobile */
                text-align: left; /* Căn trái menu mobile */
                padding: 0.8rem 0; /* Tăng khoảng cách cho dễ chạm */
                color: white;
            }
            
            .social-links-grid {
                justify-content: flex-start;
            }
            
            .logo-wrapper {
                width: 80px; /* Giảm kích thước logo trên mobile */
                height: 80px;
            }
            
            .tagline {
                display: -webkit-box;
                -webkit-line-clamp: 2; /* Giới hạn 2 dòng trên mobile */
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
            
            .brand-name {
                font-size: 1.3rem; /* Giảm kích thước chữ trên mobile */
            }
            
            .discovery-text {
                font-size: 1.4rem; /* Giảm kích thước chữ trên mobile */
            }
            
            .oval-banner-text {
                font-size: 1.4rem; /* Giảm kích thước chữ trên mobile */
            }
            
            .article-hero h1 {
                font-size: 2rem;
            }
            
            .article-meta {
                flex-direction: column;
                gap: 1rem;
            }
            
            .discovery-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 1rem;
            }
            
            .footer-column h3, .footer-column p, .contact-info {
                text-align: left;
            }
            
            .contact-info {
                justify-content: flex-start;
            }
            
            .social-links-grid {
                justify-content: flex-start;
            }
            
            .discovery-text {
                font-size: 1.2rem; /* Giảm kích thước chữ trên mobile nhỏ */
            }
            
            .oval-banner-text {
                font-size: 1.2rem; /* Giảm kích thước chữ trên mobile nhỏ */
            }
            
            .oval-banner {
                padding: 1rem 1.5rem;
            }
            
            .article-hero {
                padding: 7rem 0 3rem;
            }
            
            .article-hero h1 {
                font-size: 1.8rem;
            }
            
            .content-container {
                padding: 0 1rem;
            }
            
            .social-links-grid {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header id="main-header">
        <div class="header-container">
            <div class="logo-brand">
                <div class="logo-wrapper">
                    <img src="images/logofxf.png" alt="Ruby Wings Logo" class="logo">
                    <div class="logo-background"></div>
                </div>
                <div class="brand-info">
                    <h1 class="brand-name">RUBY WINGS</h1>
                    <p class="tagline">Hành trình trải nghiệm</p>
                </div>
            </div>
            
            <nav class="main-nav">
                <ul class="nav-links" id="navLinks">
                    <li><a href="index.html" class="nav-link">Trang chủ</a></li>
                    <li><a href="thien-va-suc-khoe.html" class="nav-link active">Thiền & Sức khoẻ</a></li>
                    <li><a href="chua-lanh-tu-nhien/" class="nav-link">C.lành tự nhiên</a></li>
                    <li><a href="khung-hoang-tinh-than-tre-em.html" class="nav-link">Chữa lành thương tổn</a></li>
                    <li><a href="dong-tay-chua-lanh/" class="nav-link">Đông Tây C.lành</a></li>
                    <li><a href="cong-dong-chua-lanh/" class="nav-link">Cộng đồng chữa lành</a></li>
                    <li><a href="yoga-tri-lieu/" class="nav-link">Yoga & trị liệu</a></li>
                    <li><a href="#contact" class="nav-link contact-btn">Liên hệ</a></li>
                </ul>
                
                <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle mobile menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </nav>
        </div>
    </header>

    <!-- Article Hero Section -->
    <section class="article-hero">
        <div class="container">
            <h1>KHI TÂM TRƯỢT DỐC TỪ NHỮNG ĐIỀU RẤT NHỎ: BÀI HỌC THỨC TỈNH TỪ MỘT VỤ ÁN GÂY CHẤN ĐỘNG</h1>
            <div class="article-meta">
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>Lương Tiến Sỹ</span>
                </div>
                
                  
                </div>
            </div>
            <p style="text-align: center;">Phân tích tâm lý và khoa học thần kinh đằng sau sự trượt dốc tinh thần - Bài học cảnh tỉnh cho mỗi người trong thời đại kỹ thuật số.</p>
        </div>
    </section>

    <!-- Article Content -->
    <section class="article-content">
        <div class="content-container">
            <!-- Phần 1 -->
            <div class="article-section">
                <h2>1. ĐOÀN VĂN SÁNG – VỤ ÁN KHIẾN CẢ XÃ HỘI SỬNG SỜ</h2>
                <!-- chèn nội dung ở đây -->
                <p>Những ngày cuối năm, mạng xã hội Việt Nam như vỡ òa trong bàng hoàng trước một vụ án mà chỉ cần đọc qua vài dòng tiêu đề thôi, ai cũng thấy lạnh sống lưng. Một người đàn ông từng là cán bộ quản lý thị trường – Đoàn Văn Sáng – bị điều tra vì liên quan đến cái chết của anh Nguyễn Xuân Đạt. Nhưng điều gây rúng động không chỉ là AN mạng… mà là cách nó diễn ra, một cách chậm rãi, kỳ quái và đầy chuẩn bị, như một “kịch bản” được hai người viết ra từ trước.

Khi lực lượng chức năng khám nghiệm hiện trường tại trụ sở Đội Quản lý thị trường số 4, hàng loạt chi tiết hiện lên như những mảnh ghép khớp đến lạnh người: không gian bếp giống hệt trong đoạn video đang lan truyền, ba chiếc răng người nằm dưới bồn rửa, những mẩu xương lẫn trong bể phốt, chiếc áo khoác và máy sưởi xuất hiện trong clip, và cả chiếc điện thoại được xác nhận là của nạn nhân. Đặc biệt, kết quả giám định cho thấy video không hề do AI dựng, tức là tất cả những gì dư luận thấy… đều là thật.

Nhưng điều khiến xã hội ám ảnh nhất không phải là hiện trường hay vật chứng, mà là câu chuyện tâm lý phía sau: Hai con người quen nhau qua mạng. Một người ôm những suy nghĩ lệch chuẩn, bị cuốn vào ham muốn kỳ dị về cái chet. Một người ban đầu từ chối… rồi dần dần bước qua từng ranh giới nhỏ của mình, cho đến khi vượt hẳn lằn ranh thiện–ác lúc nào không hay.

Câu chuyện ấy khiến nhiều người phải tự hỏi: Làm sao một người bình thường có thể biến đổi đến mức ấy?
Vì sao những nội dung lệch lạc trên mạng lại đủ sức kéo con người vào hố sâu?
Và điều gì trong tâm khiến ta rơi xuống vực chỉ từ một bước tò mò ban đầu?

Đây không chỉ là một vụ án, nó là một tấm gương soi thẳng vào thời đại này – nơi con người luôn nghĩ mình mạnh mẽ, tỉnh táo, không dễ bị ảnh hưởng… cho đến khi thực tế chứng minh điều ngược lại.

Nếu chỉ dừng lại ở phẫn nộ, chúng ta sẽ bỏ lỡ bài học quan trọng nhất:
Tâm con người mỏng manh hơn chúng ta tưởng (đừng bao giờ có niềm tin tuyệt đối rằng bản thân mình là bản lĩnh..).
Và bóng tối thường bắt đầu bằng một điều rất nhỏ mà ta nghĩ “xem một chút cũng chẳng sao”.
</p>
            </div>

            <!-- Phần 2 -->
            <div class="article-section">
                <h2>2. CƠ CHẾ TRƯỢT DỐC CỦA TÂM & NÃO BỘ — VÌ SAO CÁI XẤU DỄ LAN VÀO MÌNH ĐẾN THẾ?</h2>
                
                <h3>Không ai trở nên nguy hiểm chỉ trong một đêm. Mọi thứ bắt đầu từ… một lần tò mò.</h3>
                <!-- chèn nội dung ở đây -->
                <p>Có lẽ điều khiến xã hội rúng động trong vụ án này không chỉ là hành vi tội ác, mà là câu hỏi âm ỉ phía sau: “Điều gì khiến một người đang sống bình thường bỗng trượt xuống vực sâu như vậy?”
Nhiều người nghĩ đó là số phận đen đủi hay tính cách bất thường. Nhưng sự thật lại gần gũi hơn rất nhiều. Tâm con người không bao giờ ngã trong một cú, mà ngã trong những bước rất nhỏ – nhỏ đến mức chính ta cũng không để ý.
 Khoa học từng chỉ ra rằng: chỉ cần ta nhìn một thứ nhiều lần, não sẽ quen với nó. Điều hôm qua làm ta hoảng hốt, hôm nay chỉ thấy “cũng bình thường”, và ngày mai… có khi ta còn chủ động tìm xem thêm.
Tâm cũng hoạt động y như vậy. Mỗi ý nghĩ là một hạt giống.
Xem một lần – nó rơi vào.
Xem vài lần – nó bám rễ.
Xem nhiều lần – nó mọc lên thành thói quen bên trong mình.
Chẳng ai nghĩ mình sẽ bị ảnh hưởng. Nhưng than ôi, tâm không mạnh đến thế.
</p>
                
                <h3>Điều nguy hiểm nhất là cái xấu không cần ta mời. Chỉ cần ta không đóng cửa.</h3>
                <!-- chèn nội dung ở đây -->
                <p>Một đoạn clip lệch chuẩn lướt qua; Một ánh mắt tò mò; Một lần “thử xem có gì ghê đâu”…
Tất cả những điều ấy giống như để cửa sổ hé mở trong đêm. Gió lạnh không xin phép, nó cứ thế tràn vào. Sự đen tối cũng vậy: chỉ cần một vết nứt nhỏ là đủ để len vào tâm, rồi nằm im chờ cơ hội lớn lên.
Đó là lý do nhiều người không hiểu tại sao mình thay đổi từ lúc nào.
Lúc họ nhìn lại, những ranh giới từng rõ ràng giờ đã mờ đi như dấu phấn sau cơn mưa.
</p>
                
                <h3>Sự thật đáng sợ là: khi tiếp xúc đủ lâu, con người sẽ quen cả những điều không nên quen.</h3>
                <!-- chèn nội dung ở đây -->
                <p>Vùng trong não giúp ta nhận biết nguy hiểm – sợ hãi – ranh giới đạo đức… sẽ yếu dần nếu ta liên tục cho nó tiếp xúc với thứ độc hại. Giống như xem phim kinh dị hoài rồi… không còn thấy kinh dị nữa.
Khi sự ghê sợ không còn, ham muốn lại tăng lên; Khi ham muốn trỗi dậy, lý trí lùi bước. Và khi lý trí mất chỗ đứng, ai cũng có thể trở thành phiên bản mà chính họ không nhận ra….
Đó chính là con đường mà Sáng – và rất nhiều người khác ngoài đời – đã vô tình bước vào.
</p>
                
                <h3>Điều đáng sợ nhất không phải là tội ác… mà là chặng đường dẫn tới tội ác quá âm thầm.</h3>
                <!-- chèn nội dung ở đây -->
                <p>Nó không bắt đầu bằng dao kéo hay tội lỗi rùng rợn. Nó bắt đầu bằng một cú lướt xem video; Một lần không tự nhắc mình “đừng xem nữa”; Một niềm tin ngây thơ rằng “mình mạnh, mình kiểm soát được”… Nhưng rồi hạt giống đã gieo, nó nằm đó, lớn dần, và một ngày nào đó – khi ta yếu lòng, khi đời xô đẩy – nó bật lên mạnh đến mức ta không còn nhận ra chính mình.</p>
                
                <h3>Vậy bài học rút ra là gì?</h3>
                <!-- chèn nội dung ở đây -->
                <p>Tâm rất mềm, nó bị ảnh hưởng dễ hơn ta tưởng, nó trượt dốc nhanh hơn ta nghĩ.
Cho nên người có trí không phải là người dám bước sát bờ vực, mà là người biết đứng xa ngay từ đầu. Biết đóng cửa sổ trước gió lạnh. Biết không gieo những hạt không cần thiết vào tâm. Biết bảo vệ mình khỏi những thứ “xem chơi thôi” nhưng lại có sức tàn phá tinh vi.

</p>
            </div>

            <!-- Highlight Box -->
            <div class="highlight-box">
                <p>"Tâm trí con người không phải là pháo đài bất khả xâm phạm. Nó là một khu vườn cần được chăm sóc mỗi ngày."</p>
            </div>

            <!-- Phần 3 -->
            <div class="article-section">
                <h2>3. BÀI HỌC LỚN – GIỮ TÂM SẠCH GIỮA THỜI ĐẠI ĐẦY KÍCH THÍCH</h2>
                
                <h3>Giữ tâm sạch không phải chuyện của người đạo đức, đó là chuyện sinh tồn.</h3>
                <!-- chèn nội dung ở đây -->
                <p>Sau tất cả, vụ án kia không chỉ là câu chuyện buồn của hai con người. Nó là lời nhắc nhở dành cho mỗi chúng ta – những người đang sống trong một thời đại mà chỉ cần mở điện thoại ra, cả thế giới ùa vào tâm mình.
Ngày xưa, muốn tìm điều xấu, ta phải đi.Bây giờ, điều xấu tìm đến ta chỉ bằng một cú vuốt màn hình. Vì thế, bài học quan trọng nhất không nằm ở vụ án… mà nằm ở tâm của chính mình.
. Trong thế giới nhiễu loạn này, tâm không được bảo vệ sẽ bị cuốn đi rất nhanh.
Không phải vì ta yếu, mà vì kích thích quá nhiều, quá mạnh, quá dồn dập. Một video bạo lực; Một nội dung lệch chuẩn; Một câu chuyện độc hại….
Chỉ cần để chúng vào tâm vài lần, sự nhạy cảm ban đầu sẽ biến mất. Ta không còn rùng mình trước điều đáng rùng mình. Ta không còn cảnh giác trước điều đáng cảnh giác. Và đó chính là lúc vết trượt bắt đầu.
</p>
                
                <h3>Tâm không mạnh như ta nghĩ — vì thế, người mạnh thật là người biết tránh.</h3>
                <!-- chèn nội dung ở đây -->
                <p>Người đời hay nghĩ bản lĩnh là dám đối mặt mọi thứ.
Nhưng bản lĩnh thật lại là biết nói “không” đúng lúc.
Biết không xem những thứ mình không nên xem.
Biết rời đi khỏi cuộc nói chuyện khiến tâm mình nặng xuống.
Biết tắt điện thoại khi thấy lòng bắt đầu xao động.
Biết giữ khoảng cách với những môi trường dễ làm mình trượt dốc.
Một hạt giống xấu không có đất thì không thể nảy mầm.
Tâm sạch là nhờ chủ ý, chứ không phải nhờ may mắn.
</p>
                
                <h3>Giữ tâm sạch không phải "gồng", mà là biết quay về.</h3>
                <!-- chèn nội dung ở đây -->
                <p>Giữa những bộn bề của cuộc sống, đôi khi điều ta cần không phải thêm sức mạnh, mà là bớt ồn ào. Tâm giống như mặt nước – càng khuấy thì càng đục. Chỉ khi ngừng lại, nó mới tự lắng trong.
Vì vậy, ta giữ tâm bằng những điều rất nhỏ:
Dành vài phút hít thở thật sâu.
Đi bộ chậm rãi thay vì cuốn theo nhịp tất bật.
Buông điện thoại một lúc để thật sự nhìn cuộc sống quanh mình.
Học cách quan sát tâm thay vì chạy theo mọi cảm xúc.
Những điều ấy tưởng nhỏ, nhưng chính là tường rào bảo vệ tâm trước cơn bão kích thích của thời đại.
</p>
                
                <h3>Điều quan trọng nhất: hãy thương lấy tâm mình.</h3>
                <!-- chèn nội dung ở đây -->
                <p>Tâm là nơi mọi vui buồn, sáng tối bắt đầu, nếu ta không chăm sóc nó, không ai chăm thay ta được. Hãy cho tâm những thứ làm nó nhẹ: ánh nắng, hơi thở, thiên nhiên, những cuộc trò chuyện lành và những chuyến đi giúp ta tìm lại phần trong trẻo bên trong mình… bởi vì giữa vô vàn ồn ào, ta chỉ có duy nhất một nơi để trở về – đó là tâm. Giữ được tâm sạch, đời tự nhiên an yên.</p>
            </div>

            <!-- Vùng khám phá hành trình -->
            <div class="discovery-highlight">
                <div class="discovery-text">❤️ "Hành trình chữa lành tâm trí bắt đầu từ việc nhận diện và điều chỉnh những thay đổi nhỏ nhất."</div>
                <div class="discovery-buttons">
                    <a href="nhung-hanh-trinh-tieu-bieu.html" class="btn-primary">Khám phá hành trình</a>
                    <a href="thien-va-suc-khoe.html" class="btn-secondary">Xem trang Thiền và Sức khoẻ</a>
                </div>
            </div>

            <!-- Phần 4 -->
            <div class="article-section">
                <h2>4. LỐI THOÁT – KHI MỖI NGƯỜI HỌC CÁCH ĐIỀU CHỈNH LẠI TÂM VÀ NÃO CỦA MÌNH</h2>
                <!-- chèn nội dung ở đây -->
                <p>Điều đáng sợ của thời đại này là chỉ cần một chiếc điện thoại, bất kỳ nội dung nào cũng có thể chảy vào đầu óc chúng ta. Nếu tiếp xúc đủ lâu với những điều lệch lạc, não bộ sẽ bị “lệch” theo. Khoa học gọi đó là khả năng tự thay đổi của não – thứ gì ta gặp nhiều, não sẽ quen với nó. Nếu gặp cái xấu thường xuyên, ta dần thấy nó “bình thường”. Nhưng điều tích cực là: nếu ta tiếp xúc với điều lành, não cũng thay đổi theo hướng lành.
Giống như việc tập thể dục giúp cơ thể khỏe lại, thì thiền và các hoạt động chậm rãi giúp não bớt căng, bớt loạn và trở về trạng thái cân bằng. Nhiều nghiên cứu chỉ ra rằng khi một người ngồi yên vài phút mỗi ngày, quan sát hơi thở và cảm xúc, những vùng não xử lý căng thẳng hoạt động nhẹ hơn, còn vùng giúp ta quyết định bình tĩnh lại hoạt động rõ ràng hơn. Từ đó, con người bớt bị cảm xúc kéo đi, bớt bốc đồng, bớt bị những kích thích xấu chiếm chỗ trong đầu.
Thiền không phải chuyện thần bí. Đó chỉ là tập cho mình một thói quen mới: biết dừng lại, biết xem mình đang nghĩ gì, và biết không chạy theo mọi thứ xuất hiện trên mạng. Khi có khả năng nhận ra tâm mình đang bị kéo đi, ta sẽ không bị dẫn dắt vào những hành vi hay nội dung gây hại. Nhờ vậy, cuộc sống ổn định hơn, đầu óc nhẹ nhàng hơn và cảm giác kiểm soát tốt hơn.
Những chuyến đi tách khỏi ồn ào cũng mang tác dụng tương tự. Khi tạm rời khỏi điện thoại, công việc và những thứ gây xao nhãng, cơ thể và đầu óc có thời gian phục hồi. Nhiều người chỉ cần vài ngày như vậy đã thấy mình tỉnh táo hơn, dễ tập trung hơn và biết mình cần điều chỉnh những gì trong cuộc sống. Đó không phải là “chữa lành” theo nghĩa lớn lao, mà đơn giản là cho não nghỉ đúng cách, để nó hoạt động bình thường trở lại.
Ngày càng nhiều người tìm đến những hoạt động nhẹ nhàng như thiền, đi bộ, ngồi bên thiên nhiên… vì họ nhận ra mình không thể sống khỏe nếu suốt ngày bị kéo bởi thông tin, lời nói, và các nội dung kích thích trên mạng. Khi có thời gian nhìn lại bản thân, họ biết rõ điều gì đang làm họ bất an, điều gì nên giữ và điều gì nên tránh.
Và có lẽ, ai cũng cần cho mình một khoảng nghỉ như vậy. Không phải để trốn chạy cuộc sống, mà để quay lại với cuộc sống trong trạng thái ổn định hơn. Khi tâm bớt loạn, quyết định của ta cũng chính xác hơn. Khi đầu óc bớt mệt, ta sống nhẹ nhàng và rõ ràng hơn. Và từ đó, những điều rủi ro – kể cả những thứ nhỏ như một đoạn clip độc hại – sẽ khó có cơ hội chen vào ảnh hưởng mình.
Giữ được tâm ổn thì cuộc sống ổn, và đôi khi, chỉ cần một hành trình ngắn để bắt đầu lại điều đó - nhất là khi có người báo cáo dựa trên những hiểu biết khoa học có tính thuyết phục liên quan đến cơ chế tâm - não, giúp ta  có được nhận thức và đủ động lực để hành động .
</p>
                
                <h3>Hiệu ứng lâu dài: Xây dựng hệ miễn dịch tinh thần</h3>
                <p>Cũng như cơ thể cần hệ miễn dịch để chống lại virus, tâm trí cần "hệ miễn dịch tinh thần" để chống lại những ảnh hưởng tiêu cực. Nghiên cứu từ Đại học Yale cho thấy chỉ 10 phút thiền mỗi ngày có thể tăng cường khả năng kiểm soát cảm xúc và giảm phản ứng với các kích thích tiêu cực.</p>
                <p>Ruby Wings mang đến những hành trình được thiết kế đặc biệt giúp bạn xây dựng hệ miễn dịch này thông qua sự kết hợp giữa thiên nhiên, thiền định và liệu pháp tâm lý. Đây không chỉ là trải nghiệm tạm thời mà là sự đầu tư cho sức khỏe tinh thần lâu dài.</p>
            </div>

            <!-- Vùng hình oval dẹt -->
            <div class="oval-banner">
                <div class="oval-banner-text">TÂM SẠCH LÀ NỀN TẢNG CỦA HẠNH PHÚC</div>
            </div>

            <div class="article-section">
                <p>Vụ án Đoàn Văn Sáng là một hồi chuông cảnh tỉnh cho tất cả chúng ta trong thời đại số. Nó cho thấy sự trượt dốc tâm lý không phải là một cú ngã đột ngột, mà là một quá trình từ từ, bắt đầu từ những lựa chọn nhỏ nhất mỗi ngày.</p>
                <p>Khoa học thần kinh đã chứng minh não bộ có tính "dẻo" - neuroplasticity. Điều này có nghĩa chúng ta có thể huấn luyện não bộ trở nên tốt hơn hoặc xấu đi. Mỗi lần bạn chọn xem nội dung tiêu cực, não bạn tạo đường mòn cho sự tiêu cực. Mỗi lần bạn chọn thiền, đọc sách hay kết nối với thiên nhiên, bạn xây dựng đường mòn cho sự tích cực.</p>
                <p>Ruby Wings không chỉ mang đến những hành trình du lịch - chúng tôi mang đến công cụ để bạn xây dựng "hệ miễn dịch tinh thần", giúp bạn nhận diện và ngăn chặn sự trượt dốc từ những bước đầu tiên. Hãy chọn đầu tư vào sức khỏe tâm trí của bạn ngay hôm nay, bởi một tâm trí khỏe mạnh là nền tảng cho mọi thành công và hạnh phúc thực sự./.</p>
            </div>

            <!-- Nút liên kết đến bài viết khác -->
            <div style="text-align: center; margin: 3rem 0;">
                <a href="Con-đuong-thoat-khoi-ton-thuong.html" class="btn-primary">
                    <i class="fas fa-heart"></i> Đọc (nghe) bài viết: "Con đường thoát khỏi tổn thương" - (cùng tác giả)
                </a>
            </div>
        </div>
    </section>

<style>
/* === RUBY WINGS CONSULTATION BUTTON - MOBILE GREEN VERSION === */
.rw-consult-btn-container {
    display: block !important;
    margin: 25px 0 !important;
    text-align: center !important;
    width: 100% !important;
}

.rw-consult-btn-main {
    /* Reset mọi style mặc định */
    all: unset !important;
    
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    text-decoration: none !important;
    
    /* Kích thước và khoảng cách */
    padding: 18px 35px !important;
    margin: 10px auto !important;
    
    /* Kiểu dáng */
    border-radius: 50px !important;
    border: 3px solid #2cec2c !important;
    font-weight: 800 !important;
    font-size: 18px !important;
    line-height: 1.3 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    
    /* Màu sắc - XANH LÁ CÂY + CHỮ VÀNG */
    background: linear-gradient(135deg, #2cec2c 0%, #22cc22 100%) !important;
    color: #ffd700 !important;
    cursor: pointer !important;
    
    /* Hiệu ứng */
    transition: all 0.4s ease !important;
    position: relative !important;
    overflow: hidden !important;
    box-shadow: 0 6px 20px rgba(44, 236, 44, 0.3) !important;
    
    /* Font chữ rõ ràng */
    font-family: 'Arial', 'Helvetica', sans-serif !important;
}

/* TEXT - CHỮ MÀU VÀNG NỔI BẬT */
.rw-consult-btn-main .rw-btn-text {
    color: #f3f5f8 !important;
    font-weight: 800 !important;
    font-size: 18px !important;
    text-shadow: 0 1px 3px rgba(0,0,0,0.3) !important;
    z-index: 2 !important;
    position: relative !important;
}

/* === HIỆU ỨNG HOVER - CHUYỂN MÀU ĐẬM DẦN === */
.rw-consult-btn-main:hover {
    transform: translateY(-4px) scale(1.05) !important;
    box-shadow: 0 12px 30px rgba(44, 236, 44, 0.5) !important;
    background: linear-gradient(135deg, #32ff32 0%, #1a991a 100%) !important;
    border-color: #32ff32 !important;
    color: #ffd700 !important;
}

.rw-consult-btn-main:hover .rw-btn-text {
    color: #ffd700 !important;
}

/* Hiệu ứng ánh sáng trượt */
.rw-consult-btn-main::before {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: -100% !important;
    width: 100% !important;
    height: 100% !important;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent) !important;
    transition: left 0.7s ease !important;
    z-index: 1 !important;
}

.rw-consult-btn-main:hover::before {
    left: 100% !important;
}

/* === MOBILE RESPONSIVE - 1 DÒNG & TỐI ƯU === */
@media (max-width: 768px) {
    .rw-consult-btn-main {
        padding: 16px 25px !important;
        font-size: 16px !important;
        width: 95% !important;
        max-width: 320px !important;
        display: flex !important; /* Đảm bảo 1 dòng */
        flex-wrap: nowrap !important;
        white-space: nowrap !important;
    }
    
    .rw-consult-btn-main .rw-btn-text {
        font-size: 16px !important;
        white-space: nowrap !important;
        /* BỎ MŨI TÊN - chỉ hiển thị text */
    }
    
    /* Ẩn hoàn toàn mũi tên trên mobile */
    .rw-consult-btn-main .rw-btn-arrow {
        display: none !important;
    }
    
    /* Màu mobile - xanh lá nhạt */
    .rw-consult-btn-main {
        background: linear-gradient(135deg, #2bdc2b 0%, #1a9f1a 100%) !important;
        border-color: #2cec2c !important;
    }
}

@media (max-width: 480px) {
    .rw-consult-btn-main {
        padding: 14px 20px !important;
        font-size: 15px !important;
        margin: 8px auto !important;
    }
    
    .rw-consult-btn-main .rw-btn-text {
        font-size: 15px !important;
        letter-spacing: 0.5px !important;
    }
}

/* Desktop - vẫn giữ mũi tên */
@media (min-width: 769px) {
    .rw-consult-btn-main .rw-btn-arrow {
        margin-left: 12px !important;
        transition: transform 0.3s ease !important;
        font-weight: bold !important;
        font-size: 18px !important;
        color: #fff3af !important;
        z-index: 2 !important;
        position: relative !important;
    }
    
    .rw-consult-btn-main:hover .rw-btn-arrow {
        transform: translateX(4px) !important;
    }
}

/* Đảm bảo không bị ảnh hưởng bởi CSS khác */
.rw-consult-btn-container * {
    box-sizing: border-box !important;
}
</style>


<script>
// === JAVASCRIPT HOÀN CHỈNH VỚI FACEBOOK PIXEL ===
function trackConsultationClick() {
    // === FACEBOOK PIXEL TRACKING - QUAN TRỌNG ===
    if (typeof fbq !== 'undefined') {
        fbq('track', 'Lead', {
            content_name: 'Đăng ký tư vấn chung - ' + document.title,
            content_category: 'General Consultation',
            page_url: window.location.href,
            button_type: 'General CTA'
        });
        console.log('Facebook Pixel: Tracked consultation click');
    } else {
        console.warn('Facebook Pixel not loaded yet');
    }
    
    // === GOOGLE ANALYTICS TRACKING (GIỮ NGUYÊN) ===
    if (typeof gtag !== 'undefined') {
        gtag('event', 'consultation_click', {
            'event_category': 'engagement',
            'event_label': 'Google Forms Consultation Button'
        });
    }
    
    console.log('Consultation button clicked - Opening: https://forms.gle/XCWf6zgFRp4Vhbw39');
    
    // === ĐẢM BẢO MỞ FORM SAU KHI TRACKING ===
    setTimeout(function() {
        window.open('https://forms.gle/XCWf6zgFRp4Vhbw39', '_blank');
    }, 100);
}

// === HIỆU ỨNG VÀ XỬ LÝ BUTTON ===
document.addEventListener('DOMContentLoaded', function() {
    const btn = document.querySelector('.rw-consult-btn-main');
    if (btn) {
        console.log('Ruby Wings Consultation Button loaded successfully');
        
        // Thêm hiệu ứng click
        btn.addEventListener('mousedown', function() {
            this.style.transform = 'translateY(-2px) scale(1.02)';
        });
        
        btn.addEventListener('mouseup', function() {
            this.style.transform = 'translateY(-4px) scale(1.05)';
        });
        
        // Xử lý sự kiện click để đảm bảo tracking
        btn.addEventListener('click', function(e) {
            // Ngăn mở link ngay lập tức
            e.preventDefault();
            // Gọi hàm tracking
            trackConsultationClick();
        });
        
        // Kiểm tra mobile
        if (window.innerWidth <= 768) {
            console.log('Mobile mode: Green background, no arrow, single line');
        }
    }
});

// === BACKUP TRACKING - NẾU PIXEL CHƯA LOAD ===
function ensurePixelTracking() {
    if (typeof fbq === 'undefined') {
        console.log('Waiting for Facebook Pixel to load...');
        setTimeout(ensurePixelTracking, 500);
    }
}

// Khởi động backup tracking
ensurePixelTracking();
</script>

    <!-- Footer -->
    <footer id="contact">
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3><a href="tuyen-ngon-sang-lap-ruby-wings.html" class="footer-title-link">Về chúng tôi</a></h3>
                    <p>Ruby Wings Travel - "Nơi bạn không chỉ đến một nơi, mà còn có thể được trở về với chính mình".</p>
                    <p> MST: 3301743759</p>
                    <div class="social-links-grid">
                        <a href="https://www.facebook.com/profile.php?id=61563772112138" target="_blank" class="social-icon facebook" title="Facebook Fanpage">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://www.facebook.com/tien.sy.5011/" target="_blank" class="social-icon facebook-personal" title="Facebook Cá nhân">
                            <i class="fas fa-user"></i>
                        </a>
                        <a href="https://x.com/TienSy379/status/1971778015232421915?t=UsXdMD8FrwjF3OO3ZnoUGg&s=19" target="_blank" class="social-icon twitter" title="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.instagram.com/tiensyrubywings?igsh=MWV3czBwMmYwYnIydA==" target="_blank" class="social-icon instagram" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://www.tiktok.com/@syluong379?_t=ZS-904eIdTTG12&_r=1" target="_blank" class="social-icon tiktok" title="TikTok">
                            <i class="fab fa-tiktok"></i>
                        </a>
                        <a href="https://www.linkedin.com/in/ti%E1%BA%BFn-s%E1%BB%B1-l%C6%B0%C6%A1ng-9a0292387?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app" target="_blank" class="social-icon linkedin" title="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://wa.me/84332510486" target="_blank" class="social-icon whatsapp" title="WhatsApp">
                            <i class="fab fa-whatsapp"></i>
                        </a>
                        <a href="https://zalo.me/84332510486" target="_blank" class="social-icon zalo" title="Zalo Nhắn tin">
                            <img src="images/zalo.jpg" alt="Zalo" class="zalo-icon">
                        </a>
                        <a href="https://www.youtube.com/@rubywing-slsa" target="_blank" class="social-icon youtube" title="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://m.me/tien.sy.5011?hash=AbY3ty4r4j7255Yb&source=qr_link_share" target="_blank" class="social-icon messenger" title="Messenger">
                            <i class="fab fa-facebook-messenger"></i>
                        </a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Liên Hệ</h3>
                    <div class="contact-info">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>148 Trương Gia Mô, Vỹ Dạ TP. Huế</span>
                    </div>
                    <div class="contact-info">
                        <i class="fas fa-phone"></i>
                        <span>0332510486</span>
                    </div>
                    <div class="contact-info">
                        <i class="fab fa-whatsapp"></i>
                        <span>0332510486 (WhatsApp/Zalo)</span>
                    </div>
                    <div class="contact-info">
                        <i class="fas fa-envelope"></i>
                        <span><a href="mailto:rubywingslsa@gmail.com">rubywingslsa@gmail.com</a></span>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Tham gia cộng đồng</h3>
                    <p>Tham gia nhóm cộng đồng Ruby Wings Travel để nhận những thông tin mới nhất, chia sẻ trải nghiệm và lan tỏa giá trị du lịch có trách nhiệm.</p>
                    <a href="https://www.facebook.com/groups/4107197836205156/" target="_blank" class="community-btn">
                        Tham gia nhóm <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
            </div>
           
        </div>
    </footer>

    <script>
/* =========================================================
   RUBY WINGS – BACK TO TOP + HEADER + MOBILE MENU (FINAL)
   UI ONLY – NO TRACKING – NO BUTTON – NO META
   COMPATIBLE WITH TOP + BOTTOM HTML
========================================================= */
(function () {
'use strict';

document.addEventListener('DOMContentLoaded', function () {

  const menuBtn  = document.getElementById('mobileMenuBtn');
  const navLinks = document.getElementById('navLinks');
  const overlay  = document.getElementById('navOverlay');
  const header   =
    document.getElementById('main-header') ||
    document.querySelector('header');

  /* ===== MOBILE MENU ===== */
  function toggleMenu(forceClose = false) {
    if (!navLinks) return;

    const isOpen = navLinks.classList.contains('active');
    const shouldOpen = forceClose ? false : !isOpen;

    navLinks.classList.toggle('active', shouldOpen);
    if (menuBtn) menuBtn.classList.toggle('active', shouldOpen);
    if (overlay) overlay.classList.toggle('active', shouldOpen);
  }

  if (menuBtn && navLinks) {
    menuBtn.addEventListener('click', function (e) {
      e.preventDefault();
      toggleMenu();
    });
  }

  if (overlay) {
    overlay.addEventListener('click', function () {
      toggleMenu(true);
    });
  }

  navLinks?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', function () {
      toggleMenu(true);
    });
  });

  /* ===== HEADER SCROLL ===== */
  let lastScrollY = window.pageYOffset || 0;
  const THRESHOLD = 100;

  window.addEventListener('scroll', function () {
    const y = window.pageYOffset || document.documentElement.scrollTop;

    if (header) {
      if (y > lastScrollY && y > THRESHOLD) {
        header.classList.add('hidden');
      } else {
        header.classList.remove('hidden');
      }
    }

    lastScrollY = y <= 0 ? 0 : y;
  }, { passive: true });

  /* ===== BACK TO TOP ===== */
  const backToTopBtn = document.getElementById('backToTop');

  if (backToTopBtn) {
    window.addEventListener('scroll', function () {
      backToTopBtn.classList.toggle(
        'visible',
        window.pageYOffset > 300
      );
    }, { passive: true });

    backToTopBtn.addEventListener('click', function () {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  }

  /* ===== SMOOTH ANCHOR ===== */
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      const target = document.querySelector(this.getAttribute('href'));
      if (!target) return;

      e.preventDefault();
      target.scrollIntoView({ behavior: 'smooth' });
      toggleMenu(true);
    });
  });

});
})();
</script>


<!-- RUBY WINGS – META PIXEL LOGIC + CONSULT BUTTON (FINAL, FIX MAP, FIX DEEPSCROLL, NO FALLBACK) -->
<script>
(function(){
'use strict';

/* =========================================================
   CONFIG
========================================================= */
const SCROLL_DEPTH = 80;
const ENGAGED_TIME = 30000;

/* =========================================================
   CONTENT ID MAP (ÉP MAP – KHÔNG AUTO)
========================================================= */
const CONTENT_ID_MAP = {
  '': 'RW_HOME',
  'nhung-hanh-trinh-tieu-bieu': 'RW_LANDING_FEATURED',
  'nhung-hanh-trinh-tham-quan-trai-nghiem-linh-hoat': 'RW_LANDING_FLEX',
  'ngon-lua-truong-son-2n1d': 'RW_TOUR_NLTSON_2N1D',
  'mua-do-va-tay-truong-son-2n1d': 'RW_TOUR_MUADO_TSON_2N1D',
  'hanh-trinh-lanh-dao-3n2d': 'RW_TOUR_LANHDAO_3N2D',
  'di-san-quoc-gia-2n1d': 'RW_TOUR_DISANQG_2N1D',
  'huyen-thoai-nguoi-phu-nu-viet-nam-3n2d': 'RW_TOUR_PHUNUVN_3N2D',
  'dmz-hoa-giai-ban-sac-4n3d': 'RW_TOUR_DMZ_4N3D',
  'hanh-trinh-trai-nghiem-linh-hoat': 'RW_FLEX_GENERAL',
  'hanh-trinh-giao-duc-ky-nang-song': 'RW_FLEX_EDU_SKILL',
  'hanh-trinh-trai-nghiem-thien-nhien': 'RW_FLEX_NATURE',
  'hanh-trinh-van-hoa-di-san': 'RW_FLEX_HERITAGE',
  'tom_tat_ho_so_hanh_trinh_mau_cho_nha_truong': 'RW_PROFILE_SCHOOL',
  '01-mo-dau-ruby-wings-la-ai': 'RW_ABOUT_01',
  '02-cau-chuyen-khoi-nguon': 'RW_ABOUT_02',
  '03-triet-ly-gia-tri': 'RW_ABOUT_03',
  '04-logo-y-nghia': 'RW_ABOUT_04',
  '05-he-sinh-thai-ruby-wings': 'RW_ABOUT_05',
  'dich-vu-du-lich-trai-nghiem': 'RW_SERVICE_EXPERIENCE',
  'dich-vu-retreat-chua-lanh': 'RW_SERVICE_RETREAT',
  'dich-vu-team-building': 'RW_SERVICE_TEAMBUILDING',
  'dich-vu-giao-duc-ky-nang': 'RW_SERVICE_EDUCATION',
  'lien-he': 'RW_CONTACT',
  'gioi-thieu': 'RW_ABOUT',
  'theo_dong_di_san_mien_trung_tu_pho_co_den_co_do': 'RW_TOUR_DISANMIENTRUNG_3N2D',
  'ky_uc_va_dai_ngan_tinh_lang_gv': 'RW_TOUR_KYUC_DAINGAN_2N1D',
  'mien_trung_di_san_kham_pha_quy_nhon_phu_yen': 'RW_TOUR_QUYNHON_PHUYEN_4N3D',
  'kham_pha_dat_viet_van_hoa_ky_quan_thien_nhien_khe_sanh_tam_dao_moc_chau': 'RW_TOUR_TAMDAO_MOCCHAU_4N3D',
  'mien_bac_di_san_tam_linh_thien_nhien': 'RW_TOUR_HALONG_NINHBINH_TAMCHUC_3N2D',
  'trai_nghiem_tinh_hoa_bac_bo_ha_noi_sa_pa_phu_tho': 'RW_TOUR_HANOI_SAPA_PHUTHO_5N4D',
  'di_san_kham_pha_ninh_binh_tam_dao_ha_long': 'RW_TOUR_NINHBINH_TAMDAO_HALONG_6N5D',
  'kham_pha_da_nang_hoi_an': 'RW_TOUR_DANANG_HOIAN_2N1D',
  'gioi_thieu_tai_lieu_bat_mach_noi_dau': 'RW_BOOK_BAT_MACH_NOI_DAU',
  'cong_dong_ban_sac_trong_nuoc': 'CONG_DONG_BAN_SAC_TRONG_NUOC',
  'ket_noi_trong_nuoc': 'KET_NOI_TRONG_NUOC',
  'lan_toa_trong_nuoc': 'LAN_TOA_TRONG_NUOC',
  'giao_duc_ky_nang_trong_nuoc': 'GIAO_DUC_KY_NANG_TRONG_NUOC',
   'trai-nghiem-linh-hoat-phu-nu': 'RW_TOUR_DONGCHAYYEUTHUONG_2N1D',
  'mua_do_va_tay_truong_son': 'RW_TOUR_MUADO_TSON_2N1D',
  'dai_ngan_truong_son_sac_xuan_mien_bien_vien': 'RW_TOUR_TRUONGSON_BIENVIEN_2N1D',
  'non-nuoc-bach-ma': 'RW_TOUR_BACHMA_1DAY',
  'sac_xuan_mien_bien_vien': 'RW_TOUR_SACXUAN_BIENVIEN_2N1D'
};

/* =========================================================
   LEAD KEYWORDS
========================================================= */
const LEAD_KEYWORDS = [
  'đăng ký',
  'đăng ký thông tin tư vấn',
  'gọi để chúng tôi tư vấn',
  'liên hệ đặt hành trình',
  'nơi nhận tư vấn',
  'nơi nhận tư vấn →',
  'liên hệ',
  'tư vấn',
  '033.251.0486'
];

/* =========================================================
   PATH KEY – FIX CHUẨN HTML TĨNH
========================================================= */
let pathKey = location.pathname
  .replace(/^\/|\/$/g,'')
  .replace('index.html','')
  .replace('.html','');

if(pathKey === '') pathKey = '';

const CONTENT_ID = CONTENT_ID_MAP[pathKey] || null;
const PAGE_TYPE = pathKey === '' ? 'home' : (CONTENT_ID ? 'page' : 'unmapped');

/* =========================================================
   VIEW CONTENT
========================================================= */
setTimeout(function () {
  if (!window.fbq || !window.RW_EVENT_ID) return;
  if (typeof CONTENT_ID === 'undefined' || typeof PAGE_TYPE === 'undefined') return;

  fbq('track', 'ViewContent', {
    content_name: document.title,
    content_category: PAGE_TYPE,
    content_ids: [CONTENT_ID],
    content_type: 'website',
    currency: 'VND',
    value: PAGE_TYPE === 'home' ? 0 : 10000,
    predicted_ltv: PAGE_TYPE === 'home' ? 0 : 1000000
  }, {
    eventID: window.RW_EVENT_ID
  });
}, 1000);


/* =========================================================
   LANDING PAGE VIEW / PAGE SCROLL / CONTENT VIEW
   SAFE – NO eventID – MID/FULL FUNNEL ONLY
========================================================= */

/* ===== 1. LANDING PAGE VIEW (1 lần / session) ===== */
if (window.fbq && !sessionStorage.getItem('rw_landing_viewed')) {
  sessionStorage.setItem('rw_landing_viewed', '1');

  fbq('trackCustom', 'LandingPageView', {
    page_type: PAGE_TYPE,
    content_id: CONTENT_ID || null,
    url: location.href
  });
}

/* ===== 2. PAGE SCROLL (25% / 50% / 75%) ===== */
const rwScrollMarks = [25, 50, 75];
const rwScrollSent = {};

window.addEventListener('scroll', function () {
  if (!window.fbq) return;

  const percent =
    (window.scrollY + window.innerHeight) /
    document.documentElement.scrollHeight * 100;

  rwScrollMarks.forEach(function (mark) {
    if (percent >= mark && !rwScrollSent[mark]) {
      rwScrollSent[mark] = true;

      fbq('trackCustom', 'PageScroll', {
        scroll_percent: mark,
        page_type: PAGE_TYPE,
        content_id: CONTENT_ID || null
      });
    }
  });
}, { passive: true });

/* ===== 3. CONTENT VIEW (PAGE ≠ HOME, 1 lần) ===== */
if (
  window.fbq &&
  PAGE_TYPE !== 'home' &&
  CONTENT_ID &&
  !sessionStorage.getItem('rw_content_viewed_' + CONTENT_ID)
) {
  sessionStorage.setItem('rw_content_viewed_' + CONTENT_ID, '1');

  fbq('trackCustom', 'ContentView', {
    content_id: CONTENT_ID,
    page_type: PAGE_TYPE,
    title: document.title
  });
}




/* =========================================================
   DEEP SCROLL (SAFE + DEDUP READY)
========================================================= */
let deepScrollSent = false;

window.addEventListener('scroll', function () {
  if (
    deepScrollSent ||
    !window.fbq ||
    !window.RW_EVENT_ID ||
    typeof CONTENT_ID === 'undefined' ||
    typeof PAGE_TYPE === 'undefined' ||
    typeof SCROLL_DEPTH === 'undefined'
  ) return;

  const percent =
    (window.scrollY + window.innerHeight) /
    document.documentElement.scrollHeight * 100;

  if (percent >= SCROLL_DEPTH) {
    deepScrollSent = true;

    fbq('trackCustom', 'DeepScroll', {
  content_id: CONTENT_ID,
  page_type: PAGE_TYPE,
  scroll_depth: SCROLL_DEPTH
});
}
}, { passive: true });


/* =========================================================
   ENGAGED VIEW (SAFE + DEDUP READY)
========================================================= */
setTimeout(function () {
  if (
    !window.fbq ||
    !window.RW_EVENT_ID ||
    typeof CONTENT_ID === 'undefined' ||
    typeof PAGE_TYPE === 'undefined' ||
    typeof ENGAGED_TIME === 'undefined'
  ) return;

  window.fbq('trackCustom', 'EngagedView', {
  content_id: CONTENT_ID,
  page_type: PAGE_TYPE,
  time_on_page: ENGAGED_TIME / 1000
});
}, ENGAGED_TIME);



/* =========================================================
   CONSULT CLICK (ENGAGEMENT ONLY – NO LEAD, SAFE + DEDUP)
========================================================= */
document.addEventListener('click', function (e) {
  if (
    !window.fbq ||
    !window.RW_EVENT_ID ||
    typeof CONTENT_ID === 'undefined' ||
    typeof PAGE_TYPE === 'undefined' ||
    typeof LEAD_KEYWORDS === 'undefined'
  ) return;

  var el = e.target.closest && e.target.closest('a,button');
  if (!el) return;

  var text = (el.innerText || '').toLowerCase();
  var isLead = LEAD_KEYWORDS.some(function (k) {
    return text.indexOf(k.toLowerCase()) !== -1;
  });
  if (!isLead) return;

  window.fbq('trackCustom', 'ConsultClick', {
  content_name: text.substring(0, 80),
  content_category: 'consultation',
  content_ids: [CONTENT_ID],
  page_type: PAGE_TYPE
});
});




/* =========================================================
   ZALO BUTTON (GÓC PHẢI, TRÊN NÚT FORM TƯ VẤN) - NÚT TRÒN
========================================================= */
const zaloRoundBtn = document.createElement('div');
zaloRoundBtn.innerHTML = `
 <a href="https://zalo.me/84332510486"
   target="_blank"
   rel="noopener noreferrer"
   id="rw-zalo-round-btn"
   aria-label="Liên hệ Zalo Ruby Wings"
   style="
     position:fixed;
     right:20px;
     bottom:80px;
     z-index:9999;
     width:60px;
     height:60px;
     border-radius:50%;
     background:linear-gradient(135deg,#0068FF,#0052CC);
     color:#ffffff;
     display:flex;
     align-items:center;
     justify-content:center;
     text-decoration:none;
     box-shadow:0 6px 16px rgba(0,0,0,.25);
     border:2px solid white;
   ">
   <img 
     src="images/zalo.jpg"
     alt=""
     style="width:30px;height:30px;border-radius:50%;object-fit:cover;"
   >
</a>
`;
document.body.appendChild(zaloRoundBtn);





/* =========================================================
   CONSULT BUTTON (GÓC PHẢI) – PIXEL + CAPI LEAD (DEDUP SAFE)
========================================================= */
const btn = document.createElement('div');
btn.innerHTML = `
 <a href="https://forms.gle/XCWf6zgFRp4Vhbw39"
   target="_blank"
   id="rw-consult-btn"
   style="
     position:fixed;
     right:20px;
     bottom:20px;
     z-index:9999;
     padding:12px 18px;
     background:linear-gradient(135deg,#16a34a,#22c55e);
     color:#ffffff;
     font-weight:700;
     font-size:14px;
     border-radius:30px;
     text-decoration:none;
     box-shadow:0 6px 16px rgba(0,0,0,.25);
   ">
   Form tư vấn
 </a>
`;
document.body.appendChild(btn);


/* =========================================================
   FAQ FUNCTIONALITY
========================================================= */
document.addEventListener('DOMContentLoaded', function() {
    const faqItems = document.querySelectorAll('.faq-item');
    
    faqItems.forEach(item => {
        const question = item.querySelector('.faq-question');
        
        question.addEventListener('click', () => {
            // Đóng tất cả các FAQ khác
            faqItems.forEach(otherItem => {
                if (otherItem !== item && otherItem.classList.contains('active')) {
                    otherItem.classList.remove('active');
                }
            });
            
            // Toggle FAQ hiện tại
            item.classList.toggle('active');
        });
    });
    
    // Tự động mở FAQ đầu tiên trên desktop
    if (window.innerWidth > 768) {
        const firstFaq = document.querySelector('.faq-item');
        if (firstFaq) {
            firstFaq.classList.add('active');
        }
    }
});

})();
</script>


<script>
// Ruby Wings Chat Widget - Complete Isolation
const BACKEND_URL = "https://ruby-wings-chatbot.onrender.com";

(function() {
    'use strict';
    
    // Kiểm tra trùng lặp
    if (window.RW_CHAT_LOADED) return;
    window.RW_CHAT_LOADED = true;
    
    // Tạo container tách biệt hoàn toàn
    const createIsolatedWidget = function() {
        // Xóa widget cũ nếu có
        const oldWidgets = document.querySelectorAll('#rw-chat-isolated, .rw-chat-isolated');
        oldWidgets.forEach(w => w.remove());
        
        // Tạo container mới
        const container = document.createElement('div');
        container.id = 'rw-chat-isolated';
        container.className = 'rw-chat-isolated';
        
        // CSS hoàn toàn tách biệt
        const styles = `
            .rw-chat-isolated {
                position: fixed !important;
                left: 0 !important;
                bottom: 0 !important;
                width: auto !important;
                height: auto !important;
                z-index: 10000 !important;
                pointer-events: none !important;
                isolation: isolate !important;
                all: initial !important;
                font-family: Arial, sans-serif !important;
            }
            
            .rw-chat-isolated * {
                pointer-events: auto !important;
                box-sizing: border-box !important;
            }
            
            .rw-chat-btn-isolated {
    position: fixed !important;
    left: 15px !important;
    bottom: 15px !important;
    width: 60px !important;
    height: 60px !important;
    border-radius: 50% !important;
    background: linear-gradient(135deg, #00d97e, #00b368) !important;
    border: 2px solid white !important; /* <--- đã thêm viền trắng */
    color: white !important;
    font-size: 24px !important;
    cursor: pointer !important;
    z-index: 10001 !important;
    box-shadow: 0 4px 20px rgba(0,217,126,0.4) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 0 !important;
    margin: 0 !important;
    -webkit-tap-highlight-color: transparent !important;
    touch-action: manipulation !important;
    overflow: hidden !important;
}
            
            .rw-chat-btn-isolated::after {
                content: "AI" !important;
                position: absolute !important;
                bottom: 5px !important;
                font-size: 11px !important;
                font-weight: bold !important;
                color: white !important;
                left: 0 !important;
                right: 0 !important;
                text-align: center !important;
            }
            
            .rw-chat-widget-isolated {
                position: fixed !important;
                left: 15px !important;
                bottom: 85px !important;
                width: calc(100vw - 30px) !important;
                max-width: 400px !important;
                height: 500px !important;
                background: white !important;
                border-radius: 12px !important;
                box-shadow: 0 10px 40px rgba(0,0,0,0.2) !important;
                z-index: 10002 !important;
                display: none !important;
                flex-direction: column !important;
                overflow: hidden !important;
                border: 1px solid #e2e8f0 !important;
                pointer-events: auto !important;
            }
            
            .rw-chat-widget-isolated.open {
                display: flex !important;
            }
            
            .rw-chat-header-isolated {
                background: linear-gradient(90deg, #00d97e, #00b368) !important;
                color: white !important;
                padding: 15px !important;
                display: flex !important;
                align-items: center !important;
                gap: 10px !important;
            }
            
            .rw-chat-avatar-isolated {
                width: 32px !important;
                height: 32px !important;
                border-radius: 8px !important;
                background: rgba(255,255,255,0.2) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                font-weight: bold !important;
                font-size: 14px !important;
            }
            
            .rw-chat-title-isolated {
                font-weight: bold !important;
                font-size: 16px !important;
                flex: 1 !important;
            }
            
            .rw-chat-close-isolated {
                background: none !important;
                border: none !important;
                color: white !important;
                font-size: 18px !important;
                cursor: pointer !important;
                width: 30px !important;
                height: 30px !important;
                border-radius: 50% !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
            }
            
            .rw-chat-body-isolated {
                flex: 1 !important;
                padding: 15px !important;
                overflow-y: auto !important;
                background: #f8fafc !important;
                display: flex !important;
                flex-direction: column !important;
                gap: 12px !important;
            }
            
            .rw-chat-message-isolated {
                max-width: 85% !important;
                padding: 12px 16px !important;
                border-radius: 12px !important;
                font-size: 14px !important;
                line-height: 1.4 !important;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
            }
            
            .rw-chat-message-bot-isolated {
                background: white !important;
                color: #1e293b !important;
                border-bottom-left-radius: 4px !important;
                align-self: flex-start !important;
            }
            
            .rw-chat-message-user-isolated {
                background: linear-gradient(90deg, #00d97e, #00b368) !important;
                color: white !important;
                border-bottom-right-radius: 4px !important;
                align-self: flex-end !important;
            }
            
            .rw-chat-input-container-isolated {
                padding: 15px !important;
                background: white !important;
                border-top: 1px solid #e2e8f0 !important;
                display: flex !important;
                gap: 8px !important;
            }
            
            .rw-chat-input-isolated {
                flex: 1 !important;
                padding: 12px !important;
                border: 2px solid #00b368 !important;
                border-radius: 8px !important;
                font-size: 14px !important;
                outline: none !important;
                background: white !important;
                color: #1e293b !important;
            }
            
            .rw-chat-input-isolated:focus {
                border-color: #00d97e !important;
                box-shadow: 0 0 0 3px rgba(0, 217, 126, 0.2) !important;
            }
            
            .rw-chat-send-isolated {
                background: linear-gradient(90deg, #00d97e, #00b368) !important;
                color: white !important;
                border: none !important;
                padding: 12px 16px !important;
                border-radius: 8px !important;
                cursor: pointer !important;
                font-weight: bold !important;
                font-size: 14px !important;
            }
            
            @media (min-width: 769px) {
                .rw-chat-btn-isolated {
                    left: 20px !important;
                    bottom: 20px !important;
                    width: 70px !important;
                    height: 70px !important;
                }
                .rw-chat-btn-isolated::after {
                    font-size: 12px !important;
                    bottom: 8px !important;
                }
                .rw-chat-widget-isolated {
                    left: 20px !important;
                    bottom: 100px !important;
                    width: 400px !important;
                }
            }
        `;
        
        // Thêm styles
        const styleEl = document.createElement('style');
        styleEl.textContent = styles;
        document.head.appendChild(styleEl);
        
        // Tạo HTML
        container.innerHTML = `
            <button class="rw-chat-btn-isolated" aria-label="Mở chat trợ lý Ruby Wings AI">🤖</button>
            <div class="rw-chat-widget-isolated">
                <div class="rw-chat-header-isolated">
                    <div class="rw-chat-avatar-isolated">AI</div>
                    <div class="rw-chat-title-isolated">Trợ lý Ruby Wings AI</div>
                    <button class="rw-chat-close-isolated" aria-label="Đóng chat">✕</button>
                </div>
                <div class="rw-chat-body-isolated">
                    <div class="rw-chat-message-isolated rw-chat-message-bot-isolated">
                        Chào bạn! Tôi là trợ lý Ruby Wings AI chuyên tư vấn về du lịch ... Tôi có thể giúp gì cho bạn?
                        <div style="font-size:11px; color:#94a3b8; margin-top:4px; text-align:right;">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
                    </div>
                </div>
                <div class="rw-chat-input-container-isolated">
                    <input type="text" class="rw-chat-input-isolated" placeholder="Chatbot vẫn đang nâng cấp...">
                    <button class="rw-chat-send-isolated">Gửi</button>
                </div>
            </div>
        `;
        
        document.body.appendChild(container);
        
        // Lấy elements
        const chatBtn = container.querySelector('.rw-chat-btn-isolated');
        const chatWidget = container.querySelector('.rw-chat-widget-isolated');
        const closeBtn = container.querySelector('.rw-chat-close-isolated');
        const sendBtn = container.querySelector('.rw-chat-send-isolated');
        const chatInput = container.querySelector('.rw-chat-input-isolated');
        const chatBody = container.querySelector('.rw-chat-body-isolated');
        
        let isOpen = false;
        
        // Event handlers đơn giản
        function toggleChat() {
            isOpen = !isOpen;
            chatWidget.classList.toggle('open', isOpen);
            if (isOpen) {
                setTimeout(() => chatInput.focus(), 100);
            }
        }
        
        function closeChat() {
            isOpen = false;
            chatWidget.classList.remove('open');
        }
        
        function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;
            
            // Thêm tin nhắn user
            addMessage(message, 'user');
            chatInput.value = '';
            
            // Hiển thị typing
            const typingMsg = addMessage('...', 'bot', true);
            
            // Gửi đến backend (FIX: Endpoint đúng /chat không có /api)
            fetch(BACKEND_URL + '/chat', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ message: message })
            })
            .then(response => response.json())
            .then(data => {
                typingMsg.remove();
                const reply = data.reply || data.message || 'Không có phản hồi từ server.';
                addMessage(reply, 'bot');
            })
            .catch(error => {
                typingMsg.remove();
                addMessage('Xin lỗi, dịch vụ tạm thời gián đoạn. Vui lòng thử lại.', 'bot');
                console.error('Chat error:', error);
            });
        }
        
        function addMessage(text, sender, isTyping = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `rw-chat-message-isolated rw-chat-message-${sender}-isolated`;
            
            if (isTyping) {
                messageDiv.innerHTML = `
                    <div style="display:flex; gap:4px; align-items:center;">
                        <div style="width:6px; height:6px; border-radius:50%; background:#00d97e; animation: bounce 1s infinite"></div>
                        <div style="width:6px; height:6px; border-radius:50%; background:#00d97e; animation: bounce 1s infinite 0.1s"></div>
                        <div style="width:6px; height:6px; border-radius:50%; background:#00d97e; animation: bounce 1s infinite 0.2s"></div>
                    </div>
                    <style>
                        @keyframes bounce {
                            0%, 100% { transform: translateY(0); }
                            50% { transform: translateY(-5px); }
                        }
                    </style>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div>${text}</div>
                    <div style="font-size:11px; opacity:0.7; margin-top:4px; text-align:${sender === 'user' ? 'left' : 'right'};">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
                `;
            }
            
            chatBody.appendChild(messageDiv);
            chatBody.scrollTop = chatBody.scrollHeight;
            return messageDiv;
        }
        
        // Gắn event listeners
        chatBtn.addEventListener('click', toggleChat);
        closeBtn.addEventListener('click', closeChat);
        sendBtn.addEventListener('click', sendMessage);
        
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
        
        // Đóng khi click bên ngoài
        document.addEventListener('click', (e) => {
            if (isOpen && !chatWidget.contains(e.target) && !chatBtn.contains(e.target)) {
                closeChat();
            }
        });
    };
    
    // Khởi tạo khi trang load
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', createIsolatedWidget);
    } else {
        createIsolatedWidget();
    }
})();

</script>
<!-- NÚT GỌI ĐIỆN RUBY WINGS - Đặt trước thẻ đóng </body> -->
<div id="ruby-call-widget" style="position: fixed; z-index: 10001;">
   <button id="ruby-call-button" style="background: linear-gradient(135deg, #00d97e, #00b368) !important; color: white; border: 2px solid white; border-radius: 50%; cursor: pointer; box-shadow: 0 6px 25px rgba(0, 217, 126, 0.4); display: flex; align-items: center; justify-content: center; transition: all 0.3s; outline: none;">
        📞
    </button>
</div>

<!-- MODAL NHẬP SỐ ĐIỆN THOẠI -->
<div id="ruby-call-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 10002; align-items: center; justify-content: center;">
    <div style="background: linear-gradient(135deg, #1a5f23 0%, #0d3b1a 100%); border-radius: 16px; padding: 30px; width: 90%; max-width: 420px; box-shadow: 0 15px 40px rgba(0,0,0,0.5); border: 2px solid #27ae60;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
            <h3 style="color: white; margin: 0; font-size: 22px; font-weight: 600; text-shadow: 1px 1px 3px rgba(0,0,0,0.3);">📞 GỌI CHO CHÚNG TÔI</h3>
            <button id="ruby-close-modal" style="background: none; border: none; font-size: 28px; cursor: pointer; color: white; padding: 0; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s;">×</button>
        </div>
        
        <div style="margin-bottom: 25px;">
            <p style="color: white; margin-bottom: 10px; font-size: 16px; font-weight: 500;">Nhập số của Bạn để gọi chúng tôi:</p>
            <input type="tel" id="ruby-phone-input" 
                   style="width: 100%; padding: 15px; background: white; color: black; border: 3px solid #27ae60; border-radius: 10px; font-size: 18px; font-weight: 500; box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);"
                   placeholder="Ví dụ: 0332 510 486" 
                   pattern="[0-9]{10,11}">
            <p style="color: #d1e7dd; font-size: 13px; margin-top: 8px; font-weight: 400;">Chúng tôi sẽ gọi lại cho bạn trong sớm nhất có thể</p>
        </div>
        
        <div style="display: flex; gap: 12px;">
            <button id="ruby-call-regular" 
                    style="flex: 1; background: linear-gradient(135deg, #27ae60 0%, #1e8449 100%); color: white; border: none; padding: 16px; border-radius: 10px; cursor: pointer; font-size: 17px; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 4px 15px rgba(39, 174, 96, 0.4); transition: all 0.3s; min-height: 55px;">
                <span style="font-size: 20px;">📞</span>
                <span>GỌI SỐ</span>
            </button>
            <button id="ruby-call-zalo" 
                    style="flex: 1; background: linear-gradient(135deg, #0068ff 0%, #0052cc 100%); color: white; border: none; padding: 16px; border-radius: 10px; cursor: pointer; font-size: 17px; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 4px 15px rgba(0, 104, 255, 0.4); transition: all 0.3s; min-height: 55px;">
                <span><img src="https://img.icons8.com/color/20/000000/zalo.png" style="width: 20px; height: 20px; filter: brightness(0) invert(1);"></span>
                <span>GỌI ZALO</span>
            </button>
        </div>
        
        <p id="ruby-call-message" style="margin-top: 20px; text-align: center; font-size: 14px; min-height: 22px; color: white; font-weight: 500;"></p>
    </div>
</div>

<style>
/* ===== STYLES FOR ALL DEVICES ===== */
#ruby-call-widget {
    position: fixed !important;
    z-index: 10001 !important;
}

#ruby-call-button {
    position: relative;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

#ruby-call-button::after {
    content: '';
    position: absolute;
    top: -5px;
    left: -5px;
    right: -5px;
    bottom: -5px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
    opacity: 0;
    transition: opacity 0.3s;
    z-index: -1;
}

#ruby-call-button:hover::after {
    opacity: 1;
}

#ruby-close-modal:hover {
    background: rgba(255, 255, 255, 0.2) !important;
    transform: rotate(90deg);
}

/* DÒNG CODE THAY THẾ */
#ruby-call-regular:hover {
    transform: translateY(-3px) !important;
    box-shadow: 0 8px 20px rgba(0, 217, 126, 0.6) !important;
    background: linear-gradient(135deg, #00d97e, #00b368) !important;
    filter: brightness(1.1);
}

#ruby-call-zalo:hover {
    transform: translateY(-3px) !important;
    box-shadow: 0 8px 20px rgba(0, 104, 255, 0.6) !important;
    background: linear-gradient(135deg, #0057d9 0%, #0047b3 100%) !important;
}

/* Input focus effects */
#ruby-phone-input:focus {
    outline: none;
    border-color: #2ecc71 !important;
    box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.3) !important;
}

/* Animation cho modal */
@keyframes rubyModalFadeIn {
    from { 
        opacity: 0; 
        transform: translateY(-30px) scale(0.95); 
    }
    to { 
        opacity: 1; 
        transform: translateY(0) scale(1); 
    }
}

@keyframes rubyButtonPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

#ruby-call-modal > div {
    animation: rubyModalFadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

/* Pulsing effect for call button */
.ruby-pulse {
    animation: rubyButtonPulse 2s infinite;
}

/* ===== DESKTOP STYLES (default) ===== */
@media (min-width: 769px) {
    #ruby-call-widget {
        bottom: 105px;
        left: 24px;
    }
    
    #ruby-call-button {
        width: 70px;
        height: 70px;
        font-size: 30px;
    }
}

/* ===== MOBILE STYLES ===== */
@media (max-width: 768px) {
    #ruby-call-widget {
        bottom: 85px;
        left: 15px;
    }
    
    #ruby-call-button {
        width: 60px;
        height: 60px;
        font-size: 26px;
    }
    
    #ruby-call-modal > div {
        padding: 25px !important;
        margin: 15px;
    }
    
    #ruby-phone-input {
        padding: 14px !important;
        font-size: 16px !important;
    }
    
    #ruby-call-regular,
    #ruby-call-zalo {
        padding: 14px !important;
        font-size: 16px !important;
        min-height: 50px !important;
    }
}

/* ===== EXTRA SMALL DEVICES ===== */
@media (max-width: 480px) {
    #ruby-call-widget {
        bottom: 85px;
        left: 15px;
    }
    
    #ruby-call-button {
        width: 60px;
        height: 60px;
        font-size: 24px;
    }
    
    #ruby-call-modal > div {
        padding: 20px !important;
    }
    
    h3 {
        font-size: 20px !important;
    }
}

/* ===== PRINT STYLES (hide on print) ===== */
@media print {
    #ruby-call-widget,
    #ruby-call-modal {
        display: none !important;
    }
}

/* ===== DARK MODE SUPPORT ===== */
@media (prefers-color-scheme: dark) {
    #ruby-phone-input {
        background: white !important;
        color: black !important;
    }
}
</style>

<script>
// Biến toàn cục để track trạng thái
let rubyCallWidgetInitialized = false;
let rubyCallWidgetVisible = true;

// Số điện thoại cố định của công ty
const RUBY_WINGS_PHONE = "0332510486";

// Hàm khởi tạo widget gọi điện
function initRubyCallWidget() {
    if (rubyCallWidgetInitialized) return;
    rubyCallWidgetInitialized = true;
    
    // DOM Elements
    const callButton = document.getElementById('ruby-call-button');
    const callModal = document.getElementById('ruby-call-modal');
    const closeButton = document.getElementById('ruby-close-modal');
    const phoneInput = document.getElementById('ruby-phone-input');
    const callRegularButton = document.getElementById('ruby-call-regular');
    const callZaloButton = document.getElementById('ruby-call-zalo');
    const messageElement = document.getElementById('ruby-call-message');
    
    // Áp dụng positioning cho widget
    function applyWidgetPosition() {
        const widget = document.getElementById('ruby-call-widget');
        if (window.innerWidth >= 769) {
            // Desktop positioning
            widget.style.bottom = '105px';
            widget.style.left = '24px';
        } else {
            // Mobile positioning
            widget.style.bottom = '85px';
            widget.style.left = '15px';
        }
    }
    
    // Apply initial position
    applyWidgetPosition();
    
    // Thêm hiệu ứng pulse cho nút
    callButton.classList.add('ruby-pulse');
    
    // Mở modal khi click nút gọi điện
    callButton.addEventListener('click', () => {
        callModal.style.display = 'flex';
        phoneInput.focus();
        phoneInput.select();
        
        // Tạm dừng hiệu ứng pulse khi mở modal
        callButton.classList.remove('ruby-pulse');
    });
    
    // Đóng modal
    closeButton.addEventListener('click', () => {
        callModal.style.display = 'none';
        messageElement.textContent = '';
        phoneInput.value = '';
        
        // Khôi phục hiệu ứng pulse
        setTimeout(() => {
            callButton.classList.add('ruby-pulse');
        }, 500);
    });
    
    // Click bên ngoài để đóng modal
    callModal.addEventListener('click', (e) => {
        if (e.target === callModal) {
            callModal.style.display = 'none';
            messageElement.textContent = '';
            phoneInput.value = '';
            
            // Khôi phục hiệu ứng pulse
            setTimeout(() => {
                callButton.classList.add('ruby-pulse');
            }, 500);
        }
    });
    
    // ESC key để đóng modal
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && callModal.style.display === 'flex') {
            callModal.style.display = 'none';
            messageElement.textContent = '';
            phoneInput.value = '';
            
            setTimeout(() => {
                callButton.classList.add('ruby-pulse');
            }, 500);
        }
    });
    
    // Hàm lưu lead vào hệ thống
    async function saveRubyLead(phoneNumber, callType) {
    const cleanPhone = phoneNumber.replace(/\D/g, '');
    if (cleanPhone.length < 10 || cleanPhone.length > 11) {
        throw new Error('Số điện thoại không hợp lệ. Vui lòng nhập 10-11 chữ số');
    }

    // 🔑 HARD DEDUP: dùng event_id từ FE (bắt buộc cho CAPI)
    const eventId = getFinalConvEventId('call');
        

    const leadData = {
        event_id: eventId,              // 🔒 QUAN TRỌNG
        phone: cleanPhone,
        source_channel: "Website",
        action_type: "Click Call Button",
        page_url: window.location.href,
        contact_name: "Khách yêu cầu gọi lại",
        service_interest: "",
        note: callType === 'zalo'
              ? "Khách yêu cầu gọi lại qua Zalo"
              : "Khách yêu cầu gọi lại trực tiếp"
    };

    const response = await fetch(
        'https://ruby-wings-chatbot.onrender.com/api/save-lead',
        {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(leadData)
        }
    );

    if (!response.ok) {
        throw new Error('Lỗi kết nối server. Vui lòng thử lại');
    }

    return { ok: true, event_id: eventId };
}

    


    // Hàm xử lý gọi điện
    async function handleCall(callType = 'regular') {
        const phoneNumber = phoneInput.value.trim();
        
        if (!phoneNumber) {
            messageElement.textContent = '⚠️ Vui lòng nhập số điện thoại';
            messageElement.style.color = '#ffcc00';
            phoneInput.focus();
            return;
        }
        
        // Hiển thị trạng thái đang xử lý
        const originalRegularText = callRegularButton.innerHTML;
        const originalZaloText = callZaloButton.innerHTML;
        
        if (callType === 'regular') {
            callRegularButton.innerHTML = '<span style="font-size: 20px;">⏳</span><span>ĐANG XỬ LÝ...</span>';
            callRegularButton.disabled = true;
            callRegularButton.style.opacity = '0.8';
        } else {
            callZaloButton.innerHTML = '<span style="font-size: 20px;">⏳</span><span>ĐANG XỬ LÝ...</span>';
            callZaloButton.disabled = true;
            callZaloButton.style.opacity = '0.8';
        }
        
        messageElement.textContent = '⏳ Đang lưu thông tin và kết nối...';
        messageElement.style.color = '#ffcc00';
        
        try {
            // 1. Lưu lead vào hệ thống
            const result = await saveRubyLead(phoneNumber, callType);
            // Track Call / Zalo conversion (Meta CAPI)
            fetch('https://ruby-wings-chatbot.onrender.com/api/track-call', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    event_id: result.event_id, 
                    phone: phoneNumber.replace(/\D/g, ''),
                    action: callType === 'zalo' ? 'Zalo Click' : 'Phone Call'
                })
            });


            // 2. Hiển thị thông báo thành công
            messageElement.innerHTML = '✅ <strong>THÀNH CÔNG!</strong> Đã gửi thông tin';
            messageElement.style.color = '#2ecc71';
            
            // 3. Chuyển hướng đến cuộc gọi/Zalo CÔNG TY (FIX: Gọi đến số công ty thay vì số khách hàng)
            setTimeout(() => {
                if (callType === 'zalo') {
                    // Mở Zalo CÔNG TY trong tab mới
                    window.open(`https://zalo.me/${RUBY_WINGS_PHONE}`, '_blank', 'noopener,noreferrer');
                } else {
                    // Gọi điện đến SỐ CÔNG TY
                    window.location.href = `tel:${RUBY_WINGS_PHONE}`;
                }
                
                // Đóng modal sau 1.5 giây
                setTimeout(() => {
                    callModal.style.display = 'none';
                    phoneInput.value = '';
                    messageElement.textContent = '';
                    
                    // Khôi phục hiệu ứng pulse
                    setTimeout(() => {
                        callButton.classList.add('ruby-pulse');
                    }, 500);
                }, 1500);
            }, 1000);
            
        } catch (error) {
            // Xử lý lỗi
            console.error('Ruby Call Widget Error:', error);
            messageElement.innerHTML = `❌ <strong>${error.message}</strong>`;
            messageElement.style.color = '#ff6b6b';
            
            // Vẫn cho phép gọi nếu API fail (fallback - GỌI ĐẾN CÔNG TY)
            setTimeout(() => {
                const userConfirmed = confirm('Hệ thống đang bận. Bạn vẫn muốn tiếp tục gọi không?');
                
                if (userConfirmed) {
                    if (callType === 'zalo') {
                        window.open(`https://zalo.me/${RUBY_WINGS_PHONE}`, '_blank', 'noopener,noreferrer');
                    } else {
                        window.location.href = `tel:${RUBY_WINGS_PHONE}`;
                    }
                    callModal.style.display = 'none';
                    phoneInput.value = '';
                    messageElement.textContent = '';
                }
            }, 2000);
        } finally {
            // Khôi phục trạng thái nút
            if (callType === 'regular') {
                setTimeout(() => {
                    callRegularButton.innerHTML = originalRegularText;
                    callRegularButton.disabled = false;
                    callRegularButton.style.opacity = '1';
                }, 1000);
            } else {
                setTimeout(() => {
                    callZaloButton.innerHTML = originalZaloText;
                    callZaloButton.disabled = false;
                    callZaloButton.style.opacity = '1';
                }, 1000);
            }
        }
    }
    
    // Gắn sự kiện cho nút gọi thường
    callRegularButton.addEventListener('click', () => handleCall('regular'));
    
    // Gắn sự kiện cho nút gọi Zalo
    callZaloButton.addEventListener('click', () => handleCall('zalo'));
    
    // Cho phép nhấn Enter để gọi thường
    phoneInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            handleCall('regular');
        }
    });
    
    // Auto-format số điện thoại
    phoneInput.addEventListener('input', (e) => {
        let value = e.target.value.replace(/\D/g, '');
        
        if (value.length > 0) {
            if (value.length <= 4) {
                value = value;
            } else if (value.length <= 7) {
                value = `${value.slice(0, 4)} ${value.slice(4)}`;
            } else {
                value = `${value.slice(0, 4)} ${value.slice(4, 7)} ${value.slice(7, 11)}`;
            }
        }
        
        e.target.value = value;
    });
    
    // Điều chỉnh vị trí nếu có chatbot
    function adjustPositionForChatbot() {
        const chatWidget = document.querySelector('#chatWidget, .chat-widget, [id*="chat"], [class*="chat"], .tawk-button, .zalo-chat-widget');
        if (chatWidget) {
            const chatRect = chatWidget.getBoundingClientRect();
            const callWidget = document.getElementById('ruby-call-widget');
            
            // Đặt nút gọi điện cao hơn nút chatbot 80px
            callWidget.style.bottom = `${chatRect.height + 80}px`;
        }
    }
    
    // Re-apply position on resize
    window.addEventListener('resize', () => {
        applyWidgetPosition();
        adjustPositionForChatbot();
    });
    
    // Kiểm tra và điều chỉnh mỗi 1 giây (phòng trường hợp chatbot load sau)
    const positionCheckInterval = setInterval(() => {
        adjustPositionForChatbot();
    }, 1000);
    
    // Initial adjustments
    setTimeout(() => {
        adjustPositionForChatbot();
    }, 1000);
    
    console.log('✅ Ruby Call Widget đã sẵn sàng - Phiên bản hoàn thiện');
}

// Khởi tạo khi DOM ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initRubyCallWidget);
} else {
    initRubyCallWidget();
}

// Đảm bảo widget vẫn hoạt động khi chuyển trang trong SPA
document.addEventListener('click', (e) => {
    if (e.target.matches('a[href*="#"]') || e.target.closest('a[href*="#"]')) {
        // Giữ widget hiển thị khi chuyển anchor link
        setTimeout(() => {
            if (window.rubyCallWidgetInitialized) {
                const widget = document.getElementById('ruby-call-widget');
                widget.style.display = 'block';
            }
        }, 100);
    }
});

// Chống ẩn widget khi scroll
window.rw_lastScrollTop = 0;
window.addEventListener('scroll', () => {
    const st = window.pageYOffset || document.documentElement.scrollTop;
    
    // Luôn hiển thị widget, không ẩn khi scroll
    const widget = document.getElementById('ruby-call-widget');
    if (widget) {
        widget.style.display = 'block';
        widget.style.opacity = '1';
    }  
    window.rw_lastScrollTop = st <= 0 ? 0 : st;
}, false);
</script>
</body>
</html>
